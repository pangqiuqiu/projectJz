{"remainingRequest":"D:\\myCompany\\project\\aaa\\new\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\myCompany\\project\\aaa\\new\\src\\views\\staff\\User.vue?vue&type=style&index=0&id=71249b58&lang=less&scoped=true&","dependencies":[{"path":"D:\\myCompany\\project\\aaa\\new\\src\\views\\staff\\User.vue","mtime":1584428023860},{"path":"D:\\myCompany\\project\\aaa\\new\\node_modules\\css-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\myCompany\\project\\aaa\\new\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"D:\\myCompany\\project\\aaa\\new\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"D:\\myCompany\\project\\aaa\\new\\node_modules\\less-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\myCompany\\project\\aaa\\new\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\myCompany\\project\\aaa\\new\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoNCmgzIHsNCiAgYmFja2dyb3VuZC1jb2xvcjogI2Y3ZjhmOTsNCiAgcGFkZGluZy1sZWZ0OiAzMHB4Ow0KICBoZWlnaHQ6IDUwcHg7DQogIGxpbmUtaGVpZ2h0OiA1MHB4Ow0KfQ0KLy8g5pCc57Si5p2h5Lu25Yy65Z+fDQouZWwtY2FyZCB7DQogIG1hcmdpbjogMTBweCAwOw0KICAuZWwtZm9ybS1pdGVtIHsNCiAgICBtYXJnaW4tcmlnaHQ6IDIwcHg7DQogICAgbWFyZ2luLWJvdHRvbTogMDsNCiAgfQ0KfQ0KLy8g5YiG6aG1DQouZWwtcGFnaW5hdGlvbiB7DQogIHRleHQtYWxpZ246IGNlbnRlcjsNCiAgbWFyZ2luOiAyMHB4IDA7DQp9DQo="},{"version":3,"sources":["User.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAoUA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"User.vue","sourceRoot":"src/views/staff","sourcesContent":["<template>\r\n  <div>\r\n    <!-- 头部标题 -->\r\n    <h3><i class=\"el-icon-user-solid\"></i> 员工管理</h3>\r\n    <!-- 搜索条件 -->\r\n    <el-card body-style=\"padding: 10px;\">\r\n      <el-form :inline=\"true\" :model=\"formInline\" class=\"demo-form-inline\">\r\n        <el-form-item label=\"省份\">\r\n          <el-select @change=\"changeProvince\" @visible-change=\"dropDownProvince($event)\" v-model=\"formInline.province\" placeholder=\"请选择省份\" size=\"mini\">\r\n            <el-option></el-option>\r\n          </el-select>\r\n        </el-form-item>\r\n        <el-form-item label=\"城市\">\r\n          <el-select :disabled=\"disabled\" @visible-change=\"dropDownCity($event)\" v-model=\"formInline.city\" placeholder=\"请选择城市\" size=\"mini\">\r\n            <el-option></el-option>\r\n          </el-select>\r\n        </el-form-item>\r\n        <el-form-item label=\"手机号\">\r\n          <el-input v-model=\"formInline.mobile\" placeholder=\"请输入手机号\" size=\"mini\"></el-input>\r\n        </el-form-item>\r\n        <el-form-item label=\"等级\">\r\n          <el-select v-model=\"formInline.level\" placeholder=\"请选择等级\" size=\"mini\">\r\n            <el-option></el-option>\r\n          </el-select>\r\n        </el-form-item>\r\n        <el-form-item>\r\n          <el-button type=\"primary\" size=\"mini\" @click=\"submit\">查询</el-button>\r\n        </el-form-item>\r\n      </el-form>\r\n    </el-card>\r\n    <!-- 增加员工 -->\r\n    <el-button type=\"success\" size=\"mini\" @click=\"addUser\" style=\"margin-bottom: 10px;\">新增账号</el-button>\r\n    <!-- 搜索结果 -->\r\n    <el-table :data=\"tableData\" border style=\"width: 100%\" :cell-style=\"{'text-align':'center'}\" :header-cell-style=\"{'text-align':'center'}\">\r\n      <el-table-column prop=\"id\" label=\"员工\"></el-table-column>\r\n      <!-- <el-table-column prop=\"dealer\" label=\"公司\"></el-table-column> -->\r\n      <el-table-column prop=\"name\" label=\"姓名\" width=\"180\"></el-table-column>\r\n      <!-- <el-table-column prop=\"level\" label=\"等级\" width=\"180\"></el-table-column> -->\r\n      <el-table-column prop=\"phone\" label=\"手机号\" width=\"180\"></el-table-column>\r\n      <el-table-column label=\"状态\" width=\"180\" prop=\"state\">\r\n        <template slot-scope=\"scope\">\r\n          <el-switch  v-model=\"scope.row.state\" @change=\"switchChange(scope.row)\" active-text=\"正常\" inactive-text=\"禁用\" :active-value=\"1\" :inactive-value=\"0\"></el-switch>\r\n        </template>\r\n      </el-table-column>\r\n      <el-table-column label=\"操作\">\r\n        <template slot-scope=\"scope\">\r\n          <el-button size=\"mini\" type=\"primary\" @click=\"handleEdit(scope.row.id)\">修改</el-button>\r\n          <el-button size=\"mini\" type=\"danger\" @click=\"handleDelete(scope.row.id)\">删除</el-button>\r\n        </template>\r\n      </el-table-column>\r\n    </el-table>\r\n    <!-- 分页 -->\r\n    <el-pagination\r\n      @current-change=\"changePage\"\r\n      hide-on-single-page\r\n      :current-page=\"currentPage\"\r\n      :page-size=\"pagesize\"\r\n      background\r\n      layout=\"prev, pager, next\"\r\n      :total=\"total\">\r\n    </el-pagination>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nlet area = window.sessionStorage.getItem('area')\r\nlet grade = window.sessionStorage.getItem('level')\r\nlet ID = window.sessionStorage.getItem('ID')\r\nexport default {\r\n  data () {\r\n    return {\r\n      // 当前城市\r\n      area: '',\r\n      // 等级\r\n      grade: null,\r\n      // 表单内容\r\n      formInline: {\r\n        grade: '', // 等级\r\n        mobile: '', // 手机号\r\n        province: '', // 省份\r\n        city: '', // 城市\r\n        company: '' // 公司\r\n      },\r\n      // 表格\r\n      tableData: [],\r\n      // 城市列表\r\n      provinceAry: [],\r\n      cityAry: [],\r\n      disAry: [],\r\n      // 初始化禁用城市\r\n      disabled: true,\r\n      // 分页\r\n      total: 0, // 总条数\r\n      currentPage: 1, // 当前页\r\n      pagesize: 10 // 每页数据\r\n    }\r\n  },\r\n  methods: {\r\n    // 获取员工列表\r\n    async getStaffList () {\r\n      // console.log(grade)\r\n      if ((JSON.parse(grade) === 1) || (JSON.parse(grade) === 2)) {\r\n        const { data: res } = await this.$http.post('/User/showUser', {\r\n          mylevel: grade,\r\n          pageSize: this.pagesize,\r\n          pageNo: this.currentPage\r\n        })\r\n        this.tableData = res.l\r\n        this.total = res.num\r\n        console.log(res)\r\n      } else {\r\n        const { data: res } = await this.$http.post('/User/showUser', {\r\n          area: area,\r\n          mydealerId: ID,\r\n          mylevel: grade,\r\n          pageSize: this.pagesize,\r\n          pageNo: this.currentPage\r\n        })\r\n        this.tableData = res.l\r\n        this.total = res.num\r\n        console.log(res)\r\n      }\r\n    },\r\n    // 获取公司ID\r\n    getDisList () {\r\n      if (this.formInline.city === '') {\r\n        return this.$message('hhh')\r\n      }\r\n    },\r\n    // 下一页\r\n    async changePage (index) {\r\n      if ((JSON.parse(grade) === 1) || (JSON.parse(grade) === 2)) {\r\n        const { data: res } = await this.$http.post('/User/showUser', {\r\n          mylevel: grade,\r\n          pageSize: this.pagesize,\r\n          pageNo: index,\r\n          phone: this.phone\r\n        })\r\n        this.tableData = res.l\r\n        this.total = res.num\r\n        console.log(res.l)\r\n      } else {\r\n        const { data: res } = await this.$http.post('/User/showUser', {\r\n          area: area,\r\n          mydealerId: ID,\r\n          mylevel: grade,\r\n          pageSize: this.pagesize,\r\n          pageNo: index,\r\n          phone: this.phone\r\n        })\r\n        this.tableData = res.l\r\n        this.total = res.num\r\n        console.log(res)\r\n      }\r\n    },\r\n    // 触发下拉事件获取省份信息\r\n    async dropDownProvince (callback) {\r\n      if (callback === true) {\r\n        const { data: res } = await this.$http.post('/Infor/getProvince')\r\n        this.provinceAry = res\r\n        // console.log(res)\r\n      }\r\n    },\r\n    // 当省份改变时，触发请求\r\n    changeProvince () {\r\n      this.disabled = false\r\n      this.formInline.city = ''\r\n    },\r\n    // 触发下拉事件获取城市信息\r\n    async dropDownCity (callback) {\r\n      if (callback === true) {\r\n        const { data: res } = await this.$http.post(`/Infor/getCityByPid`, {\r\n          provinceid: this.formInline.province\r\n        })\r\n        this.cityAry = res\r\n        // console.log(res)\r\n      }\r\n    },\r\n    // 获取公司ID\r\n    async dropDowndis (callback) {\r\n      if (callback === true) {\r\n        if (this.formInline.city === '') {\r\n          return this.$message({\r\n            showClose: true,\r\n            message: '请输入城市信息',\r\n            type: 'warning'\r\n          })\r\n        }\r\n        const { data: res } = await this.$http.post(`/dealer/showDealer`, {\r\n          city: this.formInline.city\r\n        })\r\n        // console.log(res)\r\n        this.disAry = res\r\n      }\r\n    },\r\n    // 增加员工\r\n    addUser () {\r\n      if (this.grade === 6) {\r\n        return this.$message({\r\n          showClose: true,\r\n          message: '权限不够哦',\r\n          type: 'warning'\r\n        })\r\n      }\r\n      this.$router.push('/staff/add')\r\n    },\r\n    // 点击查询按钮\r\n    async submit () {\r\n      if ((JSON.parse(grade) === 1) || (JSON.parse(grade) === 2)) {\r\n        const { data: res } = await this.$http.post('/User/showUser', {\r\n          area: this.formInline.city, // 地区\r\n          phone: this.formInline.mobile, // 电话\r\n          level: this.formInline.grade, // 条件查询等级\r\n          dealerId: this.formInline.company, // 条件查询经销商\r\n          mylevel: grade,\r\n          pageSize: this.pagesize,\r\n          pageNo: this.currentPage\r\n        })\r\n        this.tableData = res.l\r\n        this.total = res.num\r\n      } else if ((JSON.parse(grade) === 3) || (JSON.parse(grade) === 4)) {\r\n        const { data: res } = await this.$http.post('/User/showUser', {\r\n          area: area,\r\n          phone: this.formInline.mobile,\r\n          level: this.formInline.grade,\r\n          dealerId: this.formInline.company, // 条件查询经销商\r\n          mylevel: grade, // 自身等级\r\n          pageSize: this.pagesize,\r\n          pageNo: this.currentPage\r\n        })\r\n        this.tableData = res.l\r\n        this.total = res.num\r\n      } else {\r\n        const { data: res } = await this.$http.post('/User/showUser', {\r\n          area: area,\r\n          phone: this.formInline.mobile,\r\n          level: this.formInline.grade,\r\n          mylevel: grade,\r\n          mydealerId: ID, // 自身经销商ID\r\n          pageSize: this.pagesize,\r\n          pageNo: this.currentPage\r\n        })\r\n        console.log(res)\r\n        this.tableData = res.l\r\n        this.total = res.num\r\n      }\r\n    },\r\n    // 状态改变\r\n    async switchChange (row) {\r\n      const { data: res } = await this.$http.post(`/User/updateState`, {\r\n        mylevel: grade,\r\n        id: row.id\r\n      })\r\n      if (res === true) {\r\n        this.$message({\r\n          showClose: true,\r\n          message: '状态修改成功',\r\n          type: 'success'\r\n        })\r\n      } else {\r\n        this.$message({\r\n          showClose: true,\r\n          message: '权限不足 修改失败',\r\n          type: 'error'\r\n        })\r\n        this.submit()\r\n      }\r\n    },\r\n    // 删除按钮\r\n    handleDelete (id) {\r\n      this.$confirm('永久删除 确认此操作吗？', '提示', {\r\n        confirmButtonText: '确定',\r\n        cancelButtonText: '取消',\r\n        type: 'warning'\r\n      }).then(async () => {\r\n        const { data: res } = await this.$http.post(`/User/delUser`, {\r\n          mylevel: grade,\r\n          id: id\r\n        })\r\n        if (res === true) {\r\n          this.$message({\r\n            showClose: true,\r\n            message: '删除成功',\r\n            type: 'success'\r\n          })\r\n          this.submit()\r\n        } else {\r\n          this.$message({\r\n            showClose: true,\r\n            message: '删除失败',\r\n            type: 'error'\r\n          })\r\n        }\r\n      }).catch(() => {\r\n        this.$message({\r\n          type: 'info',\r\n          message: '已取消删除'\r\n        })\r\n      })\r\n    },\r\n    // 修改按钮\r\n    handleEdit (id) {\r\n      this.$router.push({\r\n        path: '/staff/edit',\r\n        query: { id: id }\r\n      })\r\n    }\r\n  },\r\n  created () {\r\n    // 获取员工列表\r\n    this.getStaffList()\r\n  },\r\n  mounted () {\r\n    // 获取本地存储的用户等级\r\n    this.grade = JSON.parse(sessionStorage.getItem('level'))\r\n    this.getStaffList()\r\n    // console.log(this.grade)\r\n  },\r\n  computed: {\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\nh3 {\r\n  background-color: #f7f8f9;\r\n  padding-left: 30px;\r\n  height: 50px;\r\n  line-height: 50px;\r\n}\r\n// 搜索条件区域\r\n.el-card {\r\n  margin: 10px 0;\r\n  .el-form-item {\r\n    margin-right: 20px;\r\n    margin-bottom: 0;\r\n  }\r\n}\r\n// 分页\r\n.el-pagination {\r\n  text-align: center;\r\n  margin: 20px 0;\r\n}\r\n</style>\r\n"]}]}