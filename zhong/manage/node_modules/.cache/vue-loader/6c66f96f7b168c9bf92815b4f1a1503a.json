{"remainingRequest":"D:\\myCompany\\zhongdianqiche\\manage\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\myCompany\\zhongdianqiche\\manage\\src\\views\\specialSale\\Add.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\myCompany\\zhongdianqiche\\manage\\src\\views\\specialSale\\Add.vue","mtime":1587104819988},{"path":"D:\\myCompany\\zhongdianqiche\\manage\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\myCompany\\zhongdianqiche\\manage\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"D:\\myCompany\\zhongdianqiche\\manage\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\myCompany\\zhongdianqiche\\manage\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQpleHBvcnQgZGVmYXVsdCB7DQogIGRhdGEgKCkgew0KICAgIHJldHVybiB7DQogICAgICAvLyDlk4HniYwNCiAgICAgIGJyYW5kQXJ5OiBbXSwNCiAgICAgIC8vIOezu+WIlw0KICAgICAgc2VyaWVzQXJ5OiBbXSwNCiAgICAgIC8vIOihqOWNleaVsOaNrg0KICAgICAgZm9ybTogew0KICAgICAgICBicmFuZDogJycsDQogICAgICAgIHRva2VuOiB3aW5kb3cuc2Vzc2lvblN0b3JhZ2UuZ2V0SXRlbSgndG9rZW4nKSwNCiAgICAgICAgc2VyaWVzOiBbXSwgLy8g57O75YiXDQogICAgICAgIGFjdGl2aXR5RGF0ZVM6ICcnLCAvLyDlvIDlp4vml7bpl7QNCiAgICAgICAgYWN0aXZpdHlEYXRlRTogJycgLy8g57uT5p2f5pe26Ze0DQogICAgICB9LA0KICAgICAgYnJhbmQ6ICcnIC8vIOWTgeeJjA0KICAgIH0NCiAgfSwNCiAgd2F0Y2g6IHsNCiAgICBicmFuZCAobmV3VmFsKSB7DQogICAgICB0aGlzLmdldFNlcmllcygpDQogICAgfQ0KICB9LA0KICBtZXRob2RzOiB7DQogICAgLy8g6L+U5Zue5LiK5LiA6aG16Z2iDQogICAgYmFjayAoKSB7DQogICAgICB0aGlzLiRyb3V0ZXIuZ28oLTEpDQogICAgfSwNCiAgICAvLyDojrflj5blk4HniYwNCiAgICBhc3luYyBnZXRCcmFuZCAoKSB7DQogICAgICBjb25zdCB7IGRhdGE6IHJlcyB9ID0gYXdhaXQgdGhpcy4kaHR0cC5wb3N0KCcvc2FsZS9zaG93QWRkU2FsZUJyYW5kJywgew0KICAgICAgICB0b2tlbjogd2luZG93LnNlc3Npb25TdG9yYWdlLmdldEl0ZW0oJ3Rva2VuJykNCiAgICAgIH0pDQogICAgICB0aGlzLmJyYW5kQXJ5ID0gcmVzDQogICAgfSwNCiAgICAvLyDmlLnlj5jlk4HniYzml7YNCiAgICBjaGFuZ2VCcmFuZCAoKSB7DQogICAgICB0aGlzLmdldFNlcmllcygpDQogICAgfSwNCiAgICAvLyDojrflj5bns7vliJcNCiAgICBhc3luYyBnZXRTZXJpZXMgKCkgew0KICAgICAgY29uc3R7IGRhdGE6IHJlcyB9ID0gYXdhaXQgdGhpcy4kaHR0cC5wb3N0KCcvc2FsZS9zaG93U2FsZVNlcmllcycsIHsNCiAgICAgICAgYnJhbmQ6IHRoaXMuYnJhbmQNCiAgICAgIH0pDQogICAgICB0aGlzLnNlcmllc0FyeSA9IHJlcw0KICAgIH0sDQogICAgLy8g5LqL5Lu25aSE55CG5Ye95pWwDQogICAgZGF0ZUNvbnZlcnNpb24gKHZhbHVlKSB7DQogICAgICBmdW5jdGlvbiBjaGVja1RpbWUgKGkpIHsNCiAgICAgICAgaWYgKGkgPCAxMCkgew0KICAgICAgICAgIGkgPSAnMCcgKyBpDQogICAgICAgIH0NCiAgICAgICAgcmV0dXJuIGkNCiAgICAgIH0NCiAgICAgIHZhciBkID0gbmV3IERhdGUodmFsdWUpDQogICAgICB2YXIgZGF0ZSA9IGQuZ2V0RnVsbFllYXIoKSArICctJyArIGNoZWNrVGltZShkLmdldE1vbnRoKCkgKyAxKSArICctJyArIGNoZWNrVGltZShkLmdldERhdGUoKSkNCiAgICAgIHJldHVybiBkYXRlDQogICAgfSwNCiAgICAvLyDmj5DkuqTnibnljZYNCiAgICBhc3luYyBzdWJtaXQgKCkgew0KICAgICAgdGhpcy5mb3JtLmJyYW5kID0gdGhpcy5icmFuZA0KICAgICAgdGhpcy5mb3JtLmFjdGl2aXR5RGF0ZVMgPSB0aGlzLmRhdGVDb252ZXJzaW9uKHRoaXMuZm9ybS5hY3Rpdml0eURhdGVTKQ0KICAgICAgdGhpcy5mb3JtLmFjdGl2aXR5RGF0ZUUgPSB0aGlzLmRhdGVDb252ZXJzaW9uKHRoaXMuZm9ybS5hY3Rpdml0eURhdGVFKQ0KICAgICAgaWYgKHRoaXMuZm9ybS5icmFuZCA9PT0gJycgfHwgdGhpcy5mb3JtLnNlcmllcy5sZW5ndGggPT09IDAgfHwgdGhpcy5mb3JtLmFjdGl2aXR5RGF0ZVMgPT09ICdOYU4tTmFOLU5hTiBOYU46TmFOOk5hTicgfHwgdGhpcy5mb3JtLmFjdGl2aXR5RGF0ZUUgPT09ICdOYU4tTmFOLU5hTiBOYU46TmFOOk5hTicpIHsNCiAgICAgICAgcmV0dXJuIHRoaXMuJG1lc3NhZ2UuZXJyb3IoJ+ivt+WwhuS/oeaBr+Whq+WGmeWujOaVtCcpDQogICAgICB9DQogICAgICAvLyDojrflj5blvZPliY3ml7bpl7QNCiAgICAgIGNvbnN0IG15RGF0ZSA9IG5ldyBEYXRlKCkNCiAgICAgIGNvbnN0IG5vdyA9IHRoaXMuZGF0ZUNvbnZlcnNpb24obXlEYXRlLmdldEZ1bGxZZWFyKCkgKyAnLScgKyAobXlEYXRlLmdldE1vbnRoKCkgKyAxKSArICctJyArIG15RGF0ZS5nZXREYXRlKCkpDQogICAgICBpZiAodGhpcy5mb3JtLmFjdGl2aXR5RGF0ZVMgPiB0aGlzLmZvcm0uYWN0aXZpdHlEYXRlRSB8fCB0aGlzLmZvcm0uYWN0aXZpdHlEYXRlUyA9PT0gdGhpcy5mb3JtLmFjdGl2aXR5RGF0ZUUgfHwgdGhpcy5mb3JtLmFjdGl2aXR5RGF0ZVMgPCBub3cgfHwgdGhpcy5mb3JtLmFjdGl2aXR5RGF0ZVMgPT09IG5vdykgew0KICAgICAgICByZXR1cm4gdGhpcy4kbWVzc2FnZS5lcnJvcign6K+35aGr5YaZ5q2j56Gu55qE54m55Y2W5pe26Ze0JykNCiAgICAgIH0NCiAgICAgIGNvbnN0IHJlcyA9IGF3YWl0IHRoaXMuJGh0dHAucG9zdCgnL3NhbGUvYWRkU2FsZScsIHRoaXMuZm9ybSkNCiAgICAgIGlmIChyZXMuZGF0YSAhPT0gdHJ1ZSB8fCByZXMuc3RhdHVzICE9PSAyMDApIHsNCiAgICAgICAgcmV0dXJuIHRoaXMuJG1lc3NhZ2UuZXJyb3IoJ+aWsOWinuWksei0pScpDQogICAgICB9DQogICAgICB0aGlzLiRyb3V0ZXIucHVzaCgnL3NwZWNpYWxTYWxlL2xpc3QnKQ0KICAgICAgdGhpcy4kbWVzc2FnZS5zdWNjZXNzKCfmlrDlop7miJDlip8nKQ0KICAgIH0NCiAgfSwNCiAgY3JlYXRlZCAoKSB7DQogICAgLy8g6I635Y+W5ZOB54mMDQogICAgdGhpcy5nZXRCcmFuZCgpDQogIH0NCn0NCg=="},{"version":3,"sources":["Add.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA6CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Add.vue","sourceRoot":"src/views/specialSale","sourcesContent":["<template>\r\n  <div>\r\n    <!-- 头部标题 -->\r\n    <div class=\"HeadTitle\">\r\n      <h2>新增特卖</h2>\r\n      <el-button type=\"text\" @click=\"back\">《《 返回</el-button>\r\n    </div>\r\n    <!-- 注意事项 -->\r\n    <div class=\"notice\">注：每次只发布一个品牌特卖系列 (开始时间为00:00:00,结束时间为24:00:00)</div>\r\n    <!-- 新增特卖表单 -->\r\n    <el-form label-position=\"right\" label-width=\"80px\" :model=\"form\" ref=\"rulesForm\">\r\n      <el-form-item label=\"品牌\">\r\n        <el-select v-model=\"brand\" placeholder=\"请选择特卖品牌\">\r\n          <el-option v-for=\"item in brandAry\" :key=\"item\" :label=\"item\" :value=\"item\" @change=\"changeBrand\"></el-option>\r\n        </el-select>\r\n      </el-form-item>\r\n      <el-form-item label=\"系列\" v-show=\"this.brand !== ''\">\r\n        <el-checkbox-group v-model=\"form.series\">\r\n          <el-checkbox v-for=\"(item,index) in seriesAry\" :key=\"index\" :label=\"item\"></el-checkbox>\r\n        </el-checkbox-group>\r\n      </el-form-item>\r\n      <el-form-item label=\"特卖时间\" class=\"time\">\r\n        <div class=\"block\">\r\n          <el-date-picker\r\n            v-model=\"form.activityDateS\"\r\n            type=\"date\"\r\n            placeholder=\"选择开始日期\">\r\n          </el-date-picker>\r\n        </div>\r\n        <div class=\"block\">\r\n          <el-date-picker\r\n            v-model=\"form.activityDateE\"\r\n            type=\"date\"\r\n            placeholder=\"选择结束日期\">\r\n          </el-date-picker>\r\n        </div>\r\n      </el-form-item>\r\n      <el-form-item>\r\n        <el-button type=\"primary\" @click=\"submit('rulesForm')\">确认发布</el-button>\r\n      </el-form-item>\r\n    </el-form>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  data () {\r\n    return {\r\n      // 品牌\r\n      brandAry: [],\r\n      // 系列\r\n      seriesAry: [],\r\n      // 表单数据\r\n      form: {\r\n        brand: '',\r\n        token: window.sessionStorage.getItem('token'),\r\n        series: [], // 系列\r\n        activityDateS: '', // 开始时间\r\n        activityDateE: '' // 结束时间\r\n      },\r\n      brand: '' // 品牌\r\n    }\r\n  },\r\n  watch: {\r\n    brand (newVal) {\r\n      this.getSeries()\r\n    }\r\n  },\r\n  methods: {\r\n    // 返回上一页面\r\n    back () {\r\n      this.$router.go(-1)\r\n    },\r\n    // 获取品牌\r\n    async getBrand () {\r\n      const { data: res } = await this.$http.post('/sale/showAddSaleBrand', {\r\n        token: window.sessionStorage.getItem('token')\r\n      })\r\n      this.brandAry = res\r\n    },\r\n    // 改变品牌时\r\n    changeBrand () {\r\n      this.getSeries()\r\n    },\r\n    // 获取系列\r\n    async getSeries () {\r\n      const{ data: res } = await this.$http.post('/sale/showSaleSeries', {\r\n        brand: this.brand\r\n      })\r\n      this.seriesAry = res\r\n    },\r\n    // 事件处理函数\r\n    dateConversion (value) {\r\n      function checkTime (i) {\r\n        if (i < 10) {\r\n          i = '0' + i\r\n        }\r\n        return i\r\n      }\r\n      var d = new Date(value)\r\n      var date = d.getFullYear() + '-' + checkTime(d.getMonth() + 1) + '-' + checkTime(d.getDate())\r\n      return date\r\n    },\r\n    // 提交特卖\r\n    async submit () {\r\n      this.form.brand = this.brand\r\n      this.form.activityDateS = this.dateConversion(this.form.activityDateS)\r\n      this.form.activityDateE = this.dateConversion(this.form.activityDateE)\r\n      if (this.form.brand === '' || this.form.series.length === 0 || this.form.activityDateS === 'NaN-NaN-NaN NaN:NaN:NaN' || this.form.activityDateE === 'NaN-NaN-NaN NaN:NaN:NaN') {\r\n        return this.$message.error('请将信息填写完整')\r\n      }\r\n      // 获取当前时间\r\n      const myDate = new Date()\r\n      const now = this.dateConversion(myDate.getFullYear() + '-' + (myDate.getMonth() + 1) + '-' + myDate.getDate())\r\n      if (this.form.activityDateS > this.form.activityDateE || this.form.activityDateS === this.form.activityDateE || this.form.activityDateS < now || this.form.activityDateS === now) {\r\n        return this.$message.error('请填写正确的特卖时间')\r\n      }\r\n      const res = await this.$http.post('/sale/addSale', this.form)\r\n      if (res.data !== true || res.status !== 200) {\r\n        return this.$message.error('新增失败')\r\n      }\r\n      this.$router.push('/specialSale/list')\r\n      this.$message.success('新增成功')\r\n    }\r\n  },\r\n  created () {\r\n    // 获取品牌\r\n    this.getBrand()\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n// 头部标题\r\n.HeadTitle {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  background-color: #f7f8f9;\r\n  padding-left: 30px;\r\n  height: 50px;\r\n  line-height: 50px;\r\n}\r\n// 注意\r\n.notice {\r\n  color: red;\r\n  font-size: 18px;\r\n  height: 40px;\r\n  line-height: 40px;\r\n  padding-left: 20px;\r\n}\r\n// 新增表单\r\n.el-form {\r\n  margin-top: 30px;\r\n  .el-form-item {\r\n    margin-bottom: 20px;\r\n  }\r\n  .el-button {\r\n    margin-top: 20px;\r\n    width: 300px;\r\n  }\r\n  .time {\r\n    overflow: hidden;\r\n    .block {\r\n      float: left;\r\n      margin-right: 20px;\r\n    }\r\n  }\r\n}\r\n</style>\r\n"]}]}