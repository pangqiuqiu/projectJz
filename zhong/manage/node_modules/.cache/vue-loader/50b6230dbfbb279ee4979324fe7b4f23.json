{"remainingRequest":"D:\\myCompany\\project\\aaa\\new\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\myCompany\\project\\aaa\\new\\src\\views\\adv\\Edit.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\myCompany\\project\\aaa\\new\\src\\views\\adv\\Edit.vue","mtime":1586828341700},{"path":"D:\\myCompany\\project\\aaa\\new\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\myCompany\\project\\aaa\\new\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"D:\\myCompany\\project\\aaa\\new\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\myCompany\\project\\aaa\\new\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQpleHBvcnQgZGVmYXVsdCB7DQogIGRhdGEgKCkgew0KICAgIHJldHVybiB7DQogICAgICAvLyDlub/lkYrkv6Hmga8NCiAgICAgIGFkdk9iajoge30sDQogICAgICAvLyDmj5DkuqTlkI7lj7ANCiAgICAgIGZvcm06IHsNCiAgICAgICAgdXJsOiAnJywNCiAgICAgICAgcGljOiAnJywNCiAgICAgICAgaWQ6ICcnDQogICAgICB9DQogICAgfQ0KICB9LA0KICBjcmVhdGVkICgpIHsNCiAgICAvLyDojrflj5blub/lkYrkv6Hmga8NCiAgICB0aGlzLmdldEFkdigpDQogICAgLy8g6I635Y+W5Zu+54mH5L+h5oGvDQogICAgdGhpcy5nZXRQaWMoKQ0KICB9LA0KICBtZXRob2RzOiB7DQogICAgLy8g6I635Y+W5bm/5ZGK5L+h5oGvDQogICAgZ2V0QWR2ICgpIHsNCiAgICAgIGNvbnN0IHJvdyA9IEpTT04ucGFyc2UodGhpcy4kcm91dGUucXVlcnkucm93KQ0KICAgICAgdGhpcy5hZHZPYmogPSByb3cNCiAgICAgIHRoaXMuZm9ybS5pZCA9IHRoaXMuYWR2T2JqLmlkDQogICAgfSwNCiAgICAvLyDlm77niYfkv6Hmga8NCiAgICBhc3luYyBnZXRQaWMgKCkgew0KICAgICAgY29uc3Qgcm93ID0gSlNPTi5wYXJzZSh0aGlzLiRyb3V0ZS5xdWVyeS5yb3cpDQogICAgICBjb25zdCB7IGRhdGE6IHJlcyB9ID0gYXdhaXQgdGhpcy4kaHR0cC5wb3N0KCcvYWR2L2dldEFkdicsIHsNCiAgICAgICAgaWQ6IHJvdy5pZA0KICAgICAgfSkNCiAgICAgIHRoaXMuZm9ybS5waWMgPSByZXMucGljDQogICAgICB0aGlzLmZvcm0udXJsID0gcmVzLnVybA0KICAgIH0sDQogICAgLy8g5Yig6Zmk5bm/5ZGK5YaF5a65DQogICAgYXN5bmMgZGVsZXRlZCAoKSB7DQogICAgICBjb25zdCByZXMgPSBhd2FpdCB0aGlzLiRodHRwLnBvc3QoJy9hZHYvdXBkYXRlQWR2Jywgew0KICAgICAgICBpZDogdGhpcy5mb3JtLmlkDQogICAgICB9KQ0KICAgICAgaWYgKHJlcy5zdGF0dXMgIT09IDIwMCB8fCByZXMuZGF0YSAhPT0gdHJ1ZSkgew0KICAgICAgICByZXR1cm4gdGhpcy4kbWVzc2FnZS5lcnJvcign5Yig6Zmk5aSx6LSlJykNCiAgICAgIH0NCiAgICAgIHRoaXMuJHJvdXRlci5nbygwKQ0KICAgIH0sDQogICAgLy8g5o+Q5Lqk5paw5bm/5ZGKDQogICAgdXBkYXRhICgpIHsNCiAgICAgIGlmICh0aGlzLmZvcm0udXJsID09PSBudWxsKSB7DQogICAgICAgIHJldHVybiB0aGlzLiRtZXNzYWdlLmVycm9yKCfor7floavlhpnlub/lkYrlpJbpk74nKQ0KICAgICAgfQ0KICAgICAgaWYgKHRoaXMuJHJlZnMubmV3X2ltYWdlLmZpbGVzWzBdID09PSB1bmRlZmluZWQpIHsNCiAgICAgICAgcmV0dXJuIHRoaXMuJG1lc3NhZ2UuZXJyb3IoJ+ivt+S4iuS8oOW5v+WRiuWGheWuueWbvueJhycpDQogICAgICB9DQogICAgICBjb25zdCBmb3JtRGF0YSA9IG5ldyBGb3JtRGF0YSgpDQogICAgICBmb3JtRGF0YS5hcHBlbmQoJ2ltYWdlX2RhdGEnLCB0aGlzLiRyZWZzLm5ld19pbWFnZS5maWxlc1swXSkNCiAgICAgIHRoaXMuJGh0dHAucG9zdCgnL3VwbG9hZC91cGxvYWQyJywgZm9ybURhdGEsIHsNCiAgICAgICAgaGVhZGVyczogew0KICAgICAgICAgICdDb250ZW50LVR5cGUnOiAnbXVsdGlwYXJ0L2Zvcm0tZGF0YScNCiAgICAgICAgfQ0KICAgICAgfSkudGhlbihyZXMgPT4gew0KICAgICAgICBpZiAocmVzLmRhdGEgPT09ICflm77niYfkuIrkvKDlpLHotKXvvIEnKSByZXR1cm4gdGhpcy4kbWVzc2FnZS5lcnJvcign5bm/5ZGK5LiK5Lyg5aSx6LSlJykNCiAgICAgICAgdGhpcy5mb3JtLnBpYyA9IHJlcy5kYXRhDQogICAgICAgIHRoaXMuJGh0dHAucG9zdCgnL2Fkdi91cGRhdGVBZHYnLCB0aGlzLmZvcm0pLnRoZW4ocmV3ID0+IHsNCiAgICAgICAgICBpZiAocmV3LnN0YXR1cyAhPT0gMjAwIHx8IHJldy5kYXRhICE9PSB0cnVlKSByZXR1cm4gdGhpcy4kbWVzc2FnZS5lcnJvcign5L+u5pS55aSx6LSlJykNCiAgICAgICAgICAvLyB0aGlzLiRyb3V0ZXIuZ28oMCkNCiAgICAgICAgfSkuY2F0Y2gocmV3ID0+IHsNCiAgICAgICAgICBjb25zb2xlLmxvZyhyZXcpDQogICAgICAgIH0pDQogICAgICB9KS5jYXRjaChyZXMgPT4gew0KICAgICAgICBjb25zb2xlLmxvZyhyZXMpDQogICAgICB9KQ0KICAgIH0NCiAgfQ0KfQ0K"},{"version":3,"sources":["Edit.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAwCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Edit.vue","sourceRoot":"src/views/adv","sourcesContent":["<template>\r\n  <div>\r\n    <!-- 广告位置 -->\r\n    <h2>{{this.advObj.name}}</h2>\r\n    <!-- 广告尺寸 -->\r\n    <el-row :gutter=\"20\">\r\n      <el-col :span=\"3\">尺寸大小</el-col>\r\n      <el-col :span=\"21\">{{this.advObj.size}}</el-col>\r\n    </el-row>\r\n    <!-- 广告链接 -->\r\n    <el-row :gutter=\"20\">\r\n      <el-col :span=\"3\">广告链接</el-col>\r\n      <el-col :span=\"21\">\r\n        <el-input v-model=\"form.url\" style=\"width: 400px\" placeholder=\"请输入广告链接内容\"></el-input>\r\n      </el-col>\r\n    </el-row>\r\n    <!-- 修改内容 -->\r\n    <el-row :gutter=\"20\">\r\n      <el-col :span=\"3\">修改广告内容</el-col>\r\n      <el-col :span=\"21\">\r\n        <input type=\"file\" id=\"saveImage\" name=\"myphoto\" accept=\"image/png,image/gif,image/jpeg\" ref=\"new_image\">\r\n      </el-col>\r\n    </el-row>\r\n    <!-- 广告内容 -->\r\n    <el-row :gutter=\"20\">\r\n      <el-col :span=\"24\">\r\n        <img :src=\"form.pic\" alt=\"\">\r\n      </el-col>\r\n    </el-row>\r\n    <!-- 提交 -->\r\n    <el-row :gutter=\"20\">\r\n      <el-col :span=\"24\">\r\n        <el-button type=\"success\" @click=\"updata\">提交新广告</el-button>\r\n        <el-button type=\"danger\" @click=\"deleted\">删除广告内容</el-button>\r\n      </el-col>\r\n    </el-row>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  data () {\r\n    return {\r\n      // 广告信息\r\n      advObj: {},\r\n      // 提交后台\r\n      form: {\r\n        url: '',\r\n        pic: '',\r\n        id: ''\r\n      }\r\n    }\r\n  },\r\n  created () {\r\n    // 获取广告信息\r\n    this.getAdv()\r\n    // 获取图片信息\r\n    this.getPic()\r\n  },\r\n  methods: {\r\n    // 获取广告信息\r\n    getAdv () {\r\n      const row = JSON.parse(this.$route.query.row)\r\n      this.advObj = row\r\n      this.form.id = this.advObj.id\r\n    },\r\n    // 图片信息\r\n    async getPic () {\r\n      const row = JSON.parse(this.$route.query.row)\r\n      const { data: res } = await this.$http.post('/adv/getAdv', {\r\n        id: row.id\r\n      })\r\n      this.form.pic = res.pic\r\n      this.form.url = res.url\r\n    },\r\n    // 删除广告内容\r\n    async deleted () {\r\n      const res = await this.$http.post('/adv/updateAdv', {\r\n        id: this.form.id\r\n      })\r\n      if (res.status !== 200 || res.data !== true) {\r\n        return this.$message.error('删除失败')\r\n      }\r\n      this.$router.go(0)\r\n    },\r\n    // 提交新广告\r\n    updata () {\r\n      if (this.form.url === null) {\r\n        return this.$message.error('请填写广告外链')\r\n      }\r\n      if (this.$refs.new_image.files[0] === undefined) {\r\n        return this.$message.error('请上传广告内容图片')\r\n      }\r\n      const formData = new FormData()\r\n      formData.append('image_data', this.$refs.new_image.files[0])\r\n      this.$http.post('/upload/upload2', formData, {\r\n        headers: {\r\n          'Content-Type': 'multipart/form-data'\r\n        }\r\n      }).then(res => {\r\n        if (res.data === '图片上传失败！') return this.$message.error('广告上传失败')\r\n        this.form.pic = res.data\r\n        this.$http.post('/adv/updateAdv', this.form).then(rew => {\r\n          if (rew.status !== 200 || rew.data !== true) return this.$message.error('修改失败')\r\n          // this.$router.go(0)\r\n        }).catch(rew => {\r\n          console.log(rew)\r\n        })\r\n      }).catch(res => {\r\n        console.log(res)\r\n      })\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\nh2 {\r\n  text-align: center;\r\n  margin-bottom: 30px;\r\n}\r\n.el-row {\r\n  margin-bottom: 30px;\r\n}\r\n</style>\r\n"]}]}