{"remainingRequest":"H:\\jz\\w\\zhong\\manage\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!H:\\jz\\w\\zhong\\manage\\src\\views\\activity\\aggregate\\Add.vue?vue&type=script&lang=js&","dependencies":[{"path":"H:\\jz\\w\\zhong\\manage\\src\\views\\activity\\aggregate\\Add.vue","mtime":1604720338611},{"path":"H:\\jz\\w\\zhong\\manage\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"H:\\jz\\w\\zhong\\manage\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"H:\\jz\\w\\zhong\\manage\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"H:\\jz\\w\\zhong\\manage\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQppbXBvcnQgV2FuZ2VkaXRvciBmcm9tICcuLi8uLi8uLi9jb21wb25lbnRzL2VkaXRvci9XYW5nZWRpdG9yJw0KaW1wb3J0IHsgZGF0ZUNvbnZlcnNpb24gfSBmcm9tICcuLi8uLi8uLi9hc3NldHMvanMvdGltZXIuanMnDQppbXBvcnQgUVJDb2RlIGZyb20gJ3FyY29kZWpzMicNCmV4cG9ydCBkZWZhdWx0IHsNCiAgY29tcG9uZW50czogew0KICAgIFdhbmdlZGl0b3INCiAgfSwNCiAgZGF0YSAoKSB7DQogICAgLy8g6aqM6K+B5omL5py65Y+35q2j5YiZDQogICAgY29uc3QgbW9iaWxlID0gL15bMV0oWzMtOV0pWzAtOV17OX0kLw0KICAgIGNvbnN0IGlzTW9iaWxlID0gKHJ1bGUsIHZhbHVlLCBjYWxsYmFjaykgPT4gew0KICAgICAgaWYgKCFtb2JpbGUudGVzdCh2YWx1ZSkpIHsNCiAgICAgICAgcmV0dXJuIGNhbGxiYWNrKG5ldyBFcnJvcign6K+36L6T5YWl5q2j56Gu55qE5omL5py65Y+3JykpDQogICAgICB9IGVsc2Ugew0KICAgICAgICBjYWxsYmFjaygpDQogICAgICB9DQogICAgfQ0KICAgIHJldHVybiB7DQogICAgICAvLyDlm77niYfkuIrkvKDmjqXlj6MNCiAgICAgIGFjdGlvbjogJ2h0dHBzOi8vd3d3Lnpob25nZGlhbnFpY2hlLmNvbTo0NDcvdXBsb2FkL3VwbG9hZDUnLA0KICAgICAgLy8g5ZOB54mMDQogICAgICBicmFuZExpc3Q6IFtdLA0KICAgICAgLy8g5Y+C5pWwDQogICAgICBydWxlRm9ybTogew0KICAgICAgICBuYW1lOiAnJywNCiAgICAgICAgYnJhbmQ6IFtdLA0KICAgICAgICBsb2dvOiAnJywNCiAgICAgICAgY292ZXJQaWM6ICcnLA0KICAgICAgICAvLyDml7bpl7QNCiAgICAgICAgdGltZTogW10sDQogICAgICAgIHN0YXJ0RGF0ZTogJycsDQogICAgICAgIGVuZERhdGU6ICcnLA0KICAgICAgICBwcmljZTogJycsDQogICAgICAgIGdpZnQ6ICcnLA0KICAgICAgICBrZXlJczogJ+aYvuekuicsDQogICAgICAgIGVuc3VyZTogW10sDQogICAgICAgIHByb2NlZHVyZUlzOiAn5pi+56S6JywNCiAgICAgICAgcGhvbmU6ICcnLA0KICAgICAgICBkZXRhaWxzOiAnJw0KICAgICAgfSwNCiAgICAgIC8vIOihqOWNlemqjOivgQ0KICAgICAgcnVsZXM6IHsNCiAgICAgICAgbmFtZTogWw0KICAgICAgICAgIHsgcmVxdWlyZWQ6IHRydWUsIG1lc3NhZ2U6ICfor7fovpPlhaXmtLvliqjlkI3np7AnLCB0cmlnZ2VyOiAnYmx1cicgfSwNCiAgICAgICAgICB7IG1pbjogMywgbWF4OiAzMCwgbWVzc2FnZTogJ+mVv+W6puWcqCAzIOWIsCAzMCDkuKrlrZfnrKYnLCB0cmlnZ2VyOiAnYmx1cicgfQ0KICAgICAgICBdLA0KICAgICAgICBicmFuZDogWw0KICAgICAgICAgIHsgcmVxdWlyZWQ6IHRydWUsIG1lc3NhZ2U6ICfor7fpgInmi6nmtLvliqjlj4LkuI7lk4HniYwnLCB0cmlnZ2VyOiAnY2hhbmdlJyB9DQogICAgICAgIF0sDQogICAgICAgIHRpbWU6IFsNCiAgICAgICAgICB7IHJlcXVpcmVkOiB0cnVlLCBtZXNzYWdlOiAn6K+36YCJ5oup5rS75Yqo5pe26Ze0JywgdHJpZ2dlcjogJ2NoYW5nZScgfQ0KICAgICAgICBdLA0KICAgICAgICBwcmljZTogWw0KICAgICAgICAgIHsgcmVxdWlyZWQ6IHRydWUsIG1lc3NhZ2U6ICfor7fovpPlhaXlhYXlgLzph5Hpop0nLCB0cmlnZ2VyOiAnYmx1cicgfQ0KICAgICAgICBdLA0KICAgICAgICBnaWZ0OiBbDQogICAgICAgICAgeyByZXF1aXJlZDogdHJ1ZSwgbWVzc2FnZTogJ+ivt+i+k+WFpei/lOeOsOmHkemineaIluekvOWTgeWQjeensCcsIHRyaWdnZXI6ICdibHVyJyB9DQogICAgICAgIF0sDQogICAgICAgIGVuc3VyZTogWw0KICAgICAgICAgIHsgdHlwZTogJ2FycmF5JywgcmVxdWlyZWQ6IHRydWUsIG1lc3NhZ2U6ICfor7foh7PlsJHpgInmi6nkuIDkuKrmtLvliqjkv53pmpwnLCB0cmlnZ2VyOiAnY2hhbmdlJyB9DQogICAgICAgIF0sDQogICAgICAgIHBob25lOiBbDQogICAgICAgICAgeyByZXF1aXJlZDogdHJ1ZSwgbWVzc2FnZTogJ+aJi+acuuWPt+S4jeWPr+S7peS4uuepuicsIHRyaWdnZXI6ICdibHVyJyB9LA0KICAgICAgICAgIHsgdmFsaWRhdG9yOiBpc01vYmlsZSB9DQogICAgICAgIF0NCiAgICAgIH0sDQogICAgICAvLyDkuoznu7TnoIENCiAgICAgIHFyY29kZTogbnVsbA0KICAgIH0NCiAgfSwNCiAgbWV0aG9kczogew0KICAgIC8vIOiOt+WPluWTgeeJjA0KICAgIGFzeW5jIGdldEJyYW5kICgpIHsNCiAgICAgIGNvbnN0IHsgZGF0YTogcmVzIH0gPSBhd2FpdCB0aGlzLiRodHRwLnBvc3QoJy9nYXRoZXIvZ2F0aGVyQnJhbmQnKQ0KICAgICAgdGhpcy5icmFuZExpc3QgPSByZXMNCiAgICB9LA0KICAgIC8vIOWbvueJh+S4iuS8oOWJjeeahOWbnuiwg+WHveaVsA0KICAgIGJlZm9yZUF2YXRhclVwbG9hZCAoZmlsZSkgew0KICAgICAgY29uc3QgaXNMdDJNID0gZmlsZS5zaXplIC8gMTAyNCAvIDEwMjQgPCAyDQogICAgICBpZiAoIWlzTHQyTSkgdGhpcy4kbWVzc2FnZS5lcnJvcign5LiK5Lyg5Zu+54mH5aSn5bCP5LiN6IO96LaF6L+HIDJNQiEnKQ0KICAgICAgcmV0dXJuIGlzTHQyTQ0KICAgIH0sDQogICAgLy8g5Zu+54mH5LiK5Lyg5oiQ5Yqf55qE5Zue6LCDDQogICAgaGFuZGxlQXZhdGFyU3VjY2VzczEgKHJlcykgew0KICAgICAgdGhpcy5ydWxlRm9ybS5sb2dvID0gcmVzDQogICAgfSwNCiAgICBoYW5kbGVBdmF0YXJTdWNjZXNzMiAocmVzKSB7DQogICAgICB0aGlzLnJ1bGVGb3JtLmNvdmVyUGljID0gcmVzDQogICAgfSwNCiAgICAvLyDmtLvliqjor6bmg4UNCiAgICBnZXRNc2cgKGRhdGEpIHsNCiAgICAgIHRoaXMucnVsZUZvcm0uZGV0YWlscyA9IGRhdGENCiAgICB9LA0KICAgIC8vIOWIm+W7ug0KICAgIHN1Ym1pdEZvcm0gKGZvcm1OYW1lKSB7DQogICAgICBzZXRUaW1lb3V0KCgpID0+IHsNCiAgICAgICAgdGhpcy4kcmVmc1tmb3JtTmFtZV0udmFsaWRhdGUoYXN5bmMgdmFsaWQgPT4gew0KICAgICAgICAgIGlmICghdmFsaWQpIHJldHVybiB0aGlzLiRtZXNzYWdlLmVycm9yKCfor7flrozlloTooajljZXkv6Hmga8nKQ0KICAgICAgICAgIHRoaXMucnVsZUZvcm0uc3RhcnREYXRlID0gZGF0ZUNvbnZlcnNpb24odGhpcy5ydWxlRm9ybS50aW1lWzBdKQ0KICAgICAgICAgIHRoaXMucnVsZUZvcm0uZW5kRGF0ZSA9IGRhdGVDb252ZXJzaW9uKHRoaXMucnVsZUZvcm0udGltZVsxXSkNCiAgICAgICAgICBjb25zdCB7IGRhdGE6IHJlcyB9ID0gYXdhaXQgdGhpcy4kaHR0cC5wb3N0KCcvZ2F0aGVyL2FkZEdhdGhlcicsIHRoaXMucnVsZUZvcm0pDQogICAgICAgICAgaWYgKCFyZXMpIHJldHVybiB0aGlzLiRtZXNzYWdlLmVycm9yKCfliJvlu7rlpLHotKUnKQ0KICAgICAgICAgIHRoaXMucXJjb2RlID0gbmV3IFFSQ29kZSh0aGlzLiRyZWZzLnFyQ29kZURpdiwgew0KICAgICAgICAgICAgdGV4dDogYGh0dHBzOi8vd3d3Lnpob25nZGlhbnFpY2hlLmNvbS9tb2JpbGUvIy9nYXRoZXJpbmc/aWQ9JHtyZXN9YCwgLy8g6ZyA6KaB6L2s5o2i5Li65LqM57u056CB55qE5YaF5a65DQogICAgICAgICAgICB3aWR0aDogMTAwLA0KICAgICAgICAgICAgaGVpZ2h0OiAxMDAsDQogICAgICAgICAgICBjb2xvckRhcms6ICcjMDAwMDAwJywNCiAgICAgICAgICAgIGNvbG9yTGlnaHQ6ICcjZmZmZmZmJywNCiAgICAgICAgICAgIGNvcnJlY3RMZXZlbDogUVJDb2RlLkNvcnJlY3RMZXZlbC5IDQogICAgICAgICAgfSkNCiAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHsNCiAgICAgICAgICAgIGNvbnN0IGltZ1VybCA9IHRoaXMuJHJlZnMucXJDb2RlRGl2Lmxhc3RDaGlsZC5zcmMNCiAgICAgICAgICAgIGNvbnN0IGJ5dGVzID0gd2luZG93LmF0b2IoaW1nVXJsLnNwbGl0KCcsJylbMV0pDQogICAgICAgICAgICBjb25zdCBhcnJheSA9IFtdDQogICAgICAgICAgICBmb3IobGV0IGkgPSAwOyBpIDwgYnl0ZXMubGVuZ3RoOyBpKyspIHsNCiAgICAgICAgICAgICAgYXJyYXkucHVzaChieXRlcy5jaGFyQ29kZUF0KGkpKQ0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgY29uc3QgYmxvYiA9IG5ldyBCbG9iKFtuZXcgVWludDhBcnJheShhcnJheSldLCB7dHlwZTogJ2ltYWdlL2pwZWcnfSkNCiAgICAgICAgICAgIGNvbnN0IGZvcm1EYXRhID0gbmV3IEZvcm1EYXRhKCkNCiAgICAgICAgICAgIGZvcm1EYXRhLmFwcGVuZCgnaW1hZ2VfZGF0YScsIGJsb2IsIERhdGUubm93KCkgKyAnLmpwZycpDQogICAgICAgICAgICB0aGlzLiRodHRwLnBvc3QoJ2h0dHBzOi8vd3d3Lnpob25nZGlhbnFpY2hlLmNvbTo0NDcvdXBsb2FkL3VwbG9hZDUnLCBmb3JtRGF0YSkudGhlbihyZXcgPT4gew0KICAgICAgICAgICAgICBpZiAocmV3LnN0YXR1cyA9PT0gMjAwKSB7DQogICAgICAgICAgICAgICAgdGhpcy4kaHR0cC5wb3N0KCcvZ2F0aGVyL2FkZFR3b0NvZGUnLCB7DQogICAgICAgICAgICAgICAgICB0d29Db2RlOiByZXcuZGF0YSwNCiAgICAgICAgICAgICAgICAgIGlkOiByZXMNCiAgICAgICAgICAgICAgICB9KS50aGVuKHJlcSA9PiB7DQogICAgICAgICAgICAgICAgICBpZiAocmVxLnN0YXR1cyA9PT0gMjAwKSB7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuJG1lc3NhZ2Uuc3VjY2Vzcygn5Yib5bu65oiQ5YqfJykNCiAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9KQ0KICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9KQ0KICAgICAgICAgIH0sIDEwMDApDQogICAgICAgIH0pDQogICAgICB9LCA1MDApDQogICAgfQ0KICB9LA0KICBjcmVhdGVkICgpIHsNCiAgICAvLyDojrflj5blk4HniYwNCiAgICB0aGlzLmdldEJyYW5kKCkNCiAgfQ0KfQ0K"},{"version":3,"sources":["Add.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAmFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Add.vue","sourceRoot":"src/views/activity/aggregate","sourcesContent":["<template>\r\n  <div>\r\n    <!-- 标题 -->\r\n    <h3>新建集客活动</h3>\r\n    <!-- 填写表单信息 -->\r\n    <el-form :model=\"ruleForm\" :rules=\"rules\" ref=\"ruleForm\" label-width=\"150px\" class=\"demo-ruleForm\">\r\n      <el-form-item label=\"活动名称\" prop=\"name\">\r\n        <el-input v-model=\"ruleForm.name\"></el-input>\r\n      </el-form-item>\r\n      <el-form-item label=\"参与活动的品牌\" prop=\"brand\">\r\n        <el-select multiple v-model=\"ruleForm.brand\" placeholder=\"请选择\">\r\n          <el-option v-for=\"item in brandList\" :key=\"item\" :label=\"item\" :value=\"item\"></el-option>\r\n        </el-select>\r\n      </el-form-item>\r\n      <el-form-item label=\"参与活动的logo\">\r\n        <el-upload\r\n          class=\"avatar-uploader1\"\r\n          :action=\"action\"\r\n          name=\"image_data\"\r\n          :show-file-list=\"false\"\r\n          :on-success=\"handleAvatarSuccess1\"\r\n          :before-upload=\"beforeAvatarUpload\">\r\n          <img v-if=\"ruleForm.logo\" :src=\"ruleForm.logo\" class=\"avatar\">\r\n          <i v-else class=\"el-icon-plus avatar-uploader-icon1\"></i>\r\n        </el-upload>\r\n        <div style=\"font-size: 12px; color: #999;\">尺寸 100 * 100</div>\r\n      </el-form-item>\r\n      <el-form-item label=\"封面图\">\r\n        <el-upload\r\n          class=\"avatar-uploader2\"\r\n          :action=\"action\"\r\n          name=\"image_data\"\r\n          :show-file-list=\"false\"\r\n          :on-success=\"handleAvatarSuccess2\"\r\n          :before-upload=\"beforeAvatarUpload\">\r\n          <img v-if=\"ruleForm.coverPic\" :src=\"ruleForm.coverPic\" class=\"avatar\">\r\n          <i v-else class=\"el-icon-plus avatar-uploader-icon2\"></i>\r\n        </el-upload>\r\n        <div style=\"font-size: 12px; color: #999;\">比例2 : 1</div>\r\n      </el-form-item>\r\n      <el-form-item label=\"活动时间\" prop=\"time\">\r\n        <el-date-picker v-model=\"ruleForm.time\" type=\"datetimerange\" range-separator=\"至\" start-placeholder=\"开始日期\" end-placeholder=\"结束日期\"></el-date-picker>\r\n      </el-form-item>\r\n      <el-form-item label=\"活动充值\" prop=\"price\">\r\n        <el-input v-model=\"ruleForm.price\"></el-input>元\r\n      </el-form-item>\r\n      <el-form-item label=\"返现金额或礼品名称\" prop=\"gift\">\r\n        <el-input v-model=\"ruleForm.gift\"></el-input>\r\n      </el-form-item>\r\n      <el-form-item label=\"重点汽车标识\">\r\n        <el-radio v-model=\"ruleForm.keyIs\" label=\"显示\">显示</el-radio>\r\n        <el-radio v-model=\"ruleForm.keyIs\" label=\"隐藏\">隐藏</el-radio>\r\n      </el-form-item>\r\n      <el-form-item label=\"活动保障\" prop=\"ensure\">\r\n        <el-checkbox-group v-model=\"ruleForm.ensure\">\r\n          <el-checkbox label=\"底价购车\" name=\"checkList\"></el-checkbox>\r\n          <el-checkbox label=\"保证金可退\" name=\"checkList\"></el-checkbox>\r\n          <el-checkbox label=\"正规4S店\" name=\"checkList\"></el-checkbox>\r\n          <el-checkbox label=\"旧车置换\" name=\"checkList\"></el-checkbox>\r\n          <el-checkbox label=\"可贷款\" name=\"checkList\"></el-checkbox>\r\n          <el-checkbox label=\"就近保养\" name=\"checkList\"></el-checkbox>\r\n        </el-checkbox-group>\r\n      </el-form-item>\r\n      <el-form-item label=\"活动流程\">\r\n        <el-radio v-model=\"ruleForm.procedureIs\" label=\"显示\">显示</el-radio>\r\n        <el-radio v-model=\"ruleForm.procedureIs\" label=\"隐藏\">隐藏</el-radio>\r\n      </el-form-item>\r\n      <el-form-item label=\"联系电话\" prop=\"phone\">\r\n        <el-input v-model=\"ruleForm.phone\"></el-input>\r\n      </el-form-item>\r\n      <el-form-item label=\"优惠活动详情\">\r\n        <Wangeditor @func=\"getMsg\"></Wangeditor>\r\n      </el-form-item>\r\n      <el-form-item>\r\n        <el-button type=\"primary\" @click=\"submitForm('ruleForm')\">立即创建</el-button>\r\n      </el-form-item>\r\n    </el-form>\r\n    <!-- 二维码 -->\r\n    <div id=\"qrCode\" ref=\"qrCodeDiv\" style=\"display: none\"></div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport Wangeditor from '../../../components/editor/Wangeditor'\r\nimport { dateConversion } from '../../../assets/js/timer.js'\r\nimport QRCode from 'qrcodejs2'\r\nexport default {\r\n  components: {\r\n    Wangeditor\r\n  },\r\n  data () {\r\n    // 验证手机号正则\r\n    const mobile = /^[1]([3-9])[0-9]{9}$/\r\n    const isMobile = (rule, value, callback) => {\r\n      if (!mobile.test(value)) {\r\n        return callback(new Error('请输入正确的手机号'))\r\n      } else {\r\n        callback()\r\n      }\r\n    }\r\n    return {\r\n      // 图片上传接口\r\n      action: 'https://www.zhongdianqiche.com:447/upload/upload5',\r\n      // 品牌\r\n      brandList: [],\r\n      // 参数\r\n      ruleForm: {\r\n        name: '',\r\n        brand: [],\r\n        logo: '',\r\n        coverPic: '',\r\n        // 时间\r\n        time: [],\r\n        startDate: '',\r\n        endDate: '',\r\n        price: '',\r\n        gift: '',\r\n        keyIs: '显示',\r\n        ensure: [],\r\n        procedureIs: '显示',\r\n        phone: '',\r\n        details: ''\r\n      },\r\n      // 表单验证\r\n      rules: {\r\n        name: [\r\n          { required: true, message: '请输入活动名称', trigger: 'blur' },\r\n          { min: 3, max: 30, message: '长度在 3 到 30 个字符', trigger: 'blur' }\r\n        ],\r\n        brand: [\r\n          { required: true, message: '请选择活动参与品牌', trigger: 'change' }\r\n        ],\r\n        time: [\r\n          { required: true, message: '请选择活动时间', trigger: 'change' }\r\n        ],\r\n        price: [\r\n          { required: true, message: '请输入充值金额', trigger: 'blur' }\r\n        ],\r\n        gift: [\r\n          { required: true, message: '请输入返现金额或礼品名称', trigger: 'blur' }\r\n        ],\r\n        ensure: [\r\n          { type: 'array', required: true, message: '请至少选择一个活动保障', trigger: 'change' }\r\n        ],\r\n        phone: [\r\n          { required: true, message: '手机号不可以为空', trigger: 'blur' },\r\n          { validator: isMobile }\r\n        ]\r\n      },\r\n      // 二维码\r\n      qrcode: null\r\n    }\r\n  },\r\n  methods: {\r\n    // 获取品牌\r\n    async getBrand () {\r\n      const { data: res } = await this.$http.post('/gather/gatherBrand')\r\n      this.brandList = res\r\n    },\r\n    // 图片上传前的回调函数\r\n    beforeAvatarUpload (file) {\r\n      const isLt2M = file.size / 1024 / 1024 < 2\r\n      if (!isLt2M) this.$message.error('上传图片大小不能超过 2MB!')\r\n      return isLt2M\r\n    },\r\n    // 图片上传成功的回调\r\n    handleAvatarSuccess1 (res) {\r\n      this.ruleForm.logo = res\r\n    },\r\n    handleAvatarSuccess2 (res) {\r\n      this.ruleForm.coverPic = res\r\n    },\r\n    // 活动详情\r\n    getMsg (data) {\r\n      this.ruleForm.details = data\r\n    },\r\n    // 创建\r\n    submitForm (formName) {\r\n      setTimeout(() => {\r\n        this.$refs[formName].validate(async valid => {\r\n          if (!valid) return this.$message.error('请完善表单信息')\r\n          this.ruleForm.startDate = dateConversion(this.ruleForm.time[0])\r\n          this.ruleForm.endDate = dateConversion(this.ruleForm.time[1])\r\n          const { data: res } = await this.$http.post('/gather/addGather', this.ruleForm)\r\n          if (!res) return this.$message.error('创建失败')\r\n          this.qrcode = new QRCode(this.$refs.qrCodeDiv, {\r\n            text: `https://www.zhongdianqiche.com/mobile/#/gathering?id=${res}`, // 需要转换为二维码的内容\r\n            width: 100,\r\n            height: 100,\r\n            colorDark: '#000000',\r\n            colorLight: '#ffffff',\r\n            correctLevel: QRCode.CorrectLevel.H\r\n          })\r\n          setTimeout(() => {\r\n            const imgUrl = this.$refs.qrCodeDiv.lastChild.src\r\n            const bytes = window.atob(imgUrl.split(',')[1])\r\n            const array = []\r\n            for(let i = 0; i < bytes.length; i++) {\r\n              array.push(bytes.charCodeAt(i))\r\n            }\r\n            const blob = new Blob([new Uint8Array(array)], {type: 'image/jpeg'})\r\n            const formData = new FormData()\r\n            formData.append('image_data', blob, Date.now() + '.jpg')\r\n            this.$http.post('https://www.zhongdianqiche.com:447/upload/upload5', formData).then(rew => {\r\n              if (rew.status === 200) {\r\n                this.$http.post('/gather/addTwoCode', {\r\n                  twoCode: rew.data,\r\n                  id: res\r\n                }).then(req => {\r\n                  if (req.status === 200) {\r\n                    this.$message.success('创建成功')\r\n                  }\r\n                })\r\n              }\r\n            })\r\n          }, 1000)\r\n        })\r\n      }, 500)\r\n    }\r\n  },\r\n  created () {\r\n    // 获取品牌\r\n    this.getBrand()\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n.demo-ruleForm {\r\n  margin-top: 30px;\r\n  .el-input, .el-select {\r\n    width: 400px;\r\n  }\r\n  .el-button {\r\n    width: 300px;\r\n  }\r\n  // logo上传\r\n  .avatar-uploader1 {\r\n    width: 100px;\r\n    img {\r\n      width: 100px;\r\n      height: 100px;\r\n    }\r\n  }\r\n  .avatar-uploader-icon1 {\r\n    font-size: 28px;\r\n    color: #8c939d;\r\n    width: 98px;\r\n    height: 98px;\r\n    line-height: 98px;\r\n    text-align: center;\r\n    border: 1px dashed #d9d9d9;\r\n  }\r\n  // 封面图\r\n  .avatar-uploader2 {\r\n    width: 400px;\r\n    img {\r\n      width: 400px;\r\n      height: 200px;\r\n    }\r\n  }\r\n  .avatar-uploader-icon2 {\r\n    font-size: 28px;\r\n    color: #8c939d;\r\n    width: 398px;\r\n    height: 198px;\r\n    line-height: 198px;\r\n    text-align: center;\r\n    border: 1px dashed #d9d9d9;\r\n  }\r\n}\r\n</style>\r\n"]}]}