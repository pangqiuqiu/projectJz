{"ast":null,"code":"var _jsxFileName = \"H:\\\\jz\\\\\\u524D\\u7AEF\\\\w\\\\zhong\\\\mobile\\\\src\\\\views\\\\TabOne\\\\Home\\\\index.js\";\nimport React from 'react'; // 组件\n\nimport DownloadApp from '../../../components/DownloadApp'; // axios\n\nimport axios from '../../../untils/axios';\nimport styles from './index.module.css';\nexport default class Home extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.handle = (type, id) => {\n      if (type === '重点号资讯') {\n        this.props.history.push(`/infor_details?id=${id}`);\n      } else {\n        this.props.history.push(`/video_details?id=${id}`);\n      }\n    };\n\n    this.bindHandleScroll = () => {\n      let winHeight = Math.ceil(window.scrollY + window.innerHeight);\n      return winHeight >= document.body.scrollHeight - 50; // 距离底部为50时候发送请求\n    };\n\n    this.state = {\n      list: [],\n      page: 0,\n      isLoadingMore: false\n    };\n  }\n\n  componentDidMount() {\n    // 获取首页列表数据\n    this.getHomeList(); // 监听滚动事件\n\n    const wrapper = this.refs.wrapper;\n    const loadMoreDataFn = this.loadMoreDataFn;\n    const that = this;\n    let timeCount;\n\n    function callback() {\n      const top = wrapper.getBoundingClientRect().top; // 加载更多距离顶部的距离\n\n      const windowHeight = window.screen.height; // 屏幕可视区域的高度\n\n      if (top && top < windowHeight) {\n        // 当 wrapper 已经被滚动到页面可视范围之内触发\n        loadMoreDataFn(that);\n      }\n    }\n\n    window.addEventListener('scroll', () => {\n      if (this.state.isLoadingMore) return;\n\n      if (timeCount) {\n        clearTimeout(timeCount);\n      }\n\n      timeCount = setTimeout(callback, 500);\n    }, false);\n  } // 加载更多事件\n\n\n  async loadMoreDataFn(that) {\n    await that.setState({\n      page: that.state.page + 1\n    });\n    const {\n      data: res\n    } = await axios.post('/keyN/home', {\n      pageNo: that.state.page,\n      pageSize: 14\n    });\n    that.setState({\n      list: [...that.state.list, ...res]\n    });\n  } // 获取列表数据\n\n\n  async getHomeList() {\n    const {\n      data: res\n    } = await axios.post('/keyN/home', {\n      pageNo: this.state.page,\n      pageSize: 14\n    });\n    this.setState({\n      list: res\n    });\n  } // 跳转\n\n\n  render() {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      style: {\n        paddingTop: '70px',\n        paddingBottom: '50px'\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 73,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(DownloadApp, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 75,\n        columnNumber: 9\n      }\n    }), /*#__PURE__*/React.createElement(\"ul\", {\n      className: styles.inforList,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 77,\n        columnNumber: 9\n      }\n    }, this.state.list.map(item => {\n      return /*#__PURE__*/React.createElement(\"li\", {\n        style: {\n          backgroundColor: '#fff'\n        },\n        onClick: () => {\n          this.handle(item.type, item.id);\n        },\n        className: styles.inforList_item,\n        key: item.id,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 80,\n          columnNumber: 22\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        style: {\n          borderRadius: '5px 5px 0 0',\n          overflow: 'hidden'\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 81,\n          columnNumber: 17\n        }\n      }, /*#__PURE__*/React.createElement(\"img\", {\n        alt: \"\",\n        style: {\n          height: '100%'\n        },\n        src: item.object.coverPic,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 81,\n          columnNumber: 80\n        }\n      })), /*#__PURE__*/React.createElement(\"h3\", {\n        className: styles.title,\n        style: {\n          minHeight: '48.8px',\n          overflow: 'hidden'\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 82,\n          columnNumber: 17\n        }\n      }, item.object.title), /*#__PURE__*/React.createElement(\"div\", {\n        className: styles.user,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 83,\n          columnNumber: 17\n        }\n      }, /*#__PURE__*/React.createElement(\"img\", {\n        style: {\n          width: '25px',\n          height: '25px',\n          marginRight: '10px',\n          borderRadius: '50%'\n        },\n        alt: \"\",\n        src: item.key.headPic,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 84,\n          columnNumber: 19\n        }\n      }), /*#__PURE__*/React.createElement(\"span\", {\n        style: {\n          fontSize: '12px',\n          display: 'inlineBlock',\n          width: '80px'\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 85,\n          columnNumber: 19\n        }\n      }, item.key.name), /*#__PURE__*/React.createElement(\"img\", {\n        alt: \"\",\n        style: {\n          width: '15px',\n          height: '15px',\n          verticalAlign: 'top'\n        },\n        src: require('../../../assets/home/dianzan@2x.png'),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 86,\n          columnNumber: 19\n        }\n      })));\n    })), /*#__PURE__*/React.createElement(\"div\", {\n      className: styles.loadMore,\n      ref: \"wrapper\",\n      onClick: this.loadMoreDataFn.bind(this, this),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 92,\n        columnNumber: 9\n      }\n    }));\n  }\n\n}","map":{"version":3,"sources":["H:/jz/前端/w/zhong/mobile/src/views/TabOne/Home/index.js"],"names":["React","DownloadApp","axios","styles","Home","Component","constructor","props","handle","type","id","history","push","bindHandleScroll","winHeight","Math","ceil","window","scrollY","innerHeight","document","body","scrollHeight","state","list","page","isLoadingMore","componentDidMount","getHomeList","wrapper","refs","loadMoreDataFn","that","timeCount","callback","top","getBoundingClientRect","windowHeight","screen","height","addEventListener","clearTimeout","setTimeout","setState","data","res","post","pageNo","pageSize","render","paddingTop","paddingBottom","inforList","map","item","backgroundColor","inforList_item","borderRadius","overflow","object","coverPic","title","minHeight","user","width","marginRight","key","headPic","fontSize","display","name","verticalAlign","require","loadMore","bind"],"mappings":"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","sourcesContent":["import React from 'react'\r\n// 组件\r\nimport DownloadApp from '../../../components/DownloadApp'\r\n// axios\r\nimport axios from '../../../untils/axios'\r\nimport styles from './index.module.css'\r\n\r\nexport default class Home extends React.Component {\r\n  constructor (props) {\r\n    super(props)\r\n    this.state = {\r\n      list: [],\r\n      page: 0,\r\n      isLoadingMore: false\r\n    }\r\n  }\r\n  componentDidMount () {\r\n    // 获取首页列表数据\r\n    this.getHomeList()\r\n    // 监听滚动事件\r\n    const wrapper = this.refs.wrapper\r\n    const loadMoreDataFn = this.loadMoreDataFn\r\n    const that = this\r\n    let timeCount\r\n    function callback () {\r\n      const top = wrapper.getBoundingClientRect().top // 加载更多距离顶部的距离\r\n      const windowHeight = window.screen.height // 屏幕可视区域的高度\r\n      if (top && top < windowHeight) {\r\n        // 当 wrapper 已经被滚动到页面可视范围之内触发\r\n        loadMoreDataFn(that)\r\n      } \r\n    }\r\n    window.addEventListener('scroll', () => {\r\n      if (this.state.isLoadingMore) return\r\n      if (timeCount) {\r\n        clearTimeout(timeCount)\r\n      }\r\n      timeCount = setTimeout(callback, 500)\r\n    }, false)\r\n  }\r\n  // 加载更多事件\r\n  async loadMoreDataFn (that) {\r\n    await that.setState({ page: that.state.page + 1 })\r\n    const { data: res } = await axios.post('/keyN/home', {\r\n      pageNo: that.state.page,\r\n      pageSize: 14\r\n    })\r\n    that.setState({ list: [...that.state.list,...res] })\r\n  }\r\n  // 获取列表数据\r\n  async getHomeList () {\r\n    const { data: res } = await axios.post('/keyN/home', {\r\n      pageNo: this.state.page,\r\n      pageSize: 14\r\n    })\r\n    this.setState({ list: res })\r\n  }\r\n  // 跳转\r\n  handle = (type, id) => {\r\n    if (type === '重点号资讯') {\r\n      this.props.history.push(`/infor_details?id=${id}`)\r\n    } else {\r\n      this.props.history.push(`/video_details?id=${id}`)\r\n    }\r\n  }\r\n  // 监听滚动事件\r\n  bindHandleScroll =() => {\r\n    let winHeight = Math.ceil(window.scrollY + window.innerHeight)\r\n    return winHeight >= document.body.scrollHeight - 50 // 距离底部为50时候发送请求\r\n  }\r\n  render () {\r\n    return (\r\n      <div style={{paddingTop: '70px', paddingBottom: '50px'}}>\r\n        {/* 下载APP */}\r\n        <DownloadApp></DownloadApp>\r\n        {/* 首页列表 */}\r\n        <ul className={styles.inforList}>\r\n          {\r\n            this.state.list.map(item => {\r\n              return <li style={{backgroundColor: '#fff'}} onClick={() => {this.handle(item.type,item.id)}} className={styles.inforList_item} key={item.id}>\r\n                <div style={{borderRadius: '5px 5px 0 0', overflow: 'hidden'}}><img alt=\"\" style={{height: '100%'}} src={item.object.coverPic}></img></div>\r\n                <h3 className={styles.title} style={{minHeight: '48.8px', overflow: 'hidden'}}>{item.object.title}</h3>\r\n                <div className={styles.user}>\r\n                  <img style={{width: '25px', height: '25px', marginRight: '10px', borderRadius: '50%'}} alt=\"\" src={item.key.headPic}></img>\r\n                  <span style={{fontSize: '12px', display: 'inlineBlock', width: '80px'}}>{item.key.name}</span>\r\n                  <img alt=\"\" style={{width: '15px', height: '15px', verticalAlign: 'top'}} src={require('../../../assets/home/dianzan@2x.png')} />\r\n                </div>\r\n              </li>\r\n            })\r\n          }\r\n        </ul>\r\n        <div\r\n          className={styles.loadMore}\r\n          ref=\"wrapper\"\r\n          onClick={this.loadMoreDataFn.bind(this, this)}\r\n        >\r\n        </div>\r\n      </div>\r\n    )\r\n  }\r\n}"]},"metadata":{},"sourceType":"module"}