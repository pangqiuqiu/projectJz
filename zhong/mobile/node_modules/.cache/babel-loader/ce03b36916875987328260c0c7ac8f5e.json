{"ast":null,"code":"import\"antd-mobile/lib/list/style/css\";import _List from\"antd-mobile/lib/list\";import\"antd-mobile/lib/button/style/css\";import _Button from\"antd-mobile/lib/button\";import\"antd-mobile/lib/input-item/style/css\";import _InputItem from\"antd-mobile/lib/input-item\";import _objectSpread from\"D:\\\\myCompany\\\\zhongdianqiche\\\\a\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/objectSpread2\";import\"antd-mobile/lib/toast/style/css\";import _Toast from\"antd-mobile/lib/toast\";import _regeneratorRuntime from\"D:\\\\myCompany\\\\zhongdianqiche\\\\a\\\\node_modules\\\\@babel\\\\runtime/regenerator\";import _asyncToGenerator from\"D:\\\\myCompany\\\\zhongdianqiche\\\\a\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"D:\\\\myCompany\\\\zhongdianqiche\\\\a\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from'react';import styles from'./index.module.css';import url from'url';import axios from'../../../untils/axios';import{wexinPay}from'../../../untils/wx';// 手机号正则\nvar ISMOBILE=/^[1][3,4,5,7,8,9][0-9]{9}$/;var Gathering=function Gathering(props){var id=url.parse(props.location.search,true).query.id;// 页面数据\nvar _useState=useState({}),_useState2=_slicedToArray(_useState,2),obj=_useState2[0],setObj=_useState2[1];// 用户报名信息\nvar _useState3=useState({name:'',phone:'',code:'',id:''}),_useState4=_slicedToArray(_useState3,2),user=_useState4[0],setUser=_useState4[1];// 获取页面信息\nuseEffect(function(){// 获取数据\nvar getLists=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var _yield$axios$post,res;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return axios.post('/gather/getGather',{id:id});case 2:_yield$axios$post=_context.sent;res=_yield$axios$post.data;setObj(res);case 5:case\"end\":return _context.stop();}}},_callee);}));return function getLists(){return _ref.apply(this,arguments);};}();window.location.href='https://open.weixin.qq.com/connect/oauth2/authorize?appid=wx24ef6027f6157468&redirect_uri=www.zhongdianqiche.com/mobile/%23/pay&response_type=code&scope=snsapi_base#wechat_redirect';getLists();},[]);// 获取验证码\nvar code=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:if(ISMOBILE.test(user.phone)){_context2.next=2;break;}return _context2.abrupt(\"return\",_Toast.fail('请输入正确的手机号',2));case 2:_context2.next=4;return axios.post('/user/sendCode',user);case 4:case\"end\":return _context2.stop();}}},_callee2);}));return function code(){return _ref2.apply(this,arguments);};}();// 报名参与\nvar submit=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(){var _yield$axios$post2,rew,gatherId,_yield$axios$post3,res;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:if(!(!ISMOBILE.test(user.phone)||!user.name||!/^\\d{4}$/.test(user.code))){_context3.next=2;break;}return _context3.abrupt(\"return\",_Toast.fail('请将信息填写完整',2));case 2:// 短信验证\nsetUser(_objectSpread(_objectSpread({},user),{},{id:id}));_context3.next=5;return axios.post('/user/yzCode',user);case 5:_yield$axios$post2=_context3.sent;rew=_yield$axios$post2.data;if(rew){_context3.next=9;break;}return _context3.abrupt(\"return\",_Toast.fail('手机验证码错误',2));case 9:// 提交数据\ngatherId=user.id;_context3.next=12;return axios.post('/gather/addSign',_objectSpread(_objectSpread({},user),{},{gatherId:gatherId}));case 12:_yield$axios$post3=_context3.sent;res=_yield$axios$post3.data;if(res){_context3.next=16;break;}return _context3.abrupt(\"return\",_Toast.fail('报名失败',2));case 16:wexinPay({appId:res.appId,nonceStr:res.nonceStr,package:res.package,paySign:res.paySign,signType:res.signType,timeStamp:res.timeStamp},function(){_Toast.fail('支付成功',2);});setUser({name:'',phone:'',code:'',id:''});case 18:case\"end\":return _context3.stop();}}},_callee3);}));return function submit(){return _ref3.apply(this,arguments);};}();return/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"img\",{style:{width:'100%'},src:obj.coverPic,alt:\"\\u91CD\\u70B9\\u6C7D\\u8F66\"}),/*#__PURE__*/React.createElement(\"div\",{className:styles.title},/*#__PURE__*/React.createElement(\"img\",{src:obj.logo,alt:\"\\u91CD\\u70B9\\u6C7D\\u8F66\",style:{width:'100px',height:'100px'}}),/*#__PURE__*/React.createElement(\"h2\",null,obj.name)),/*#__PURE__*/React.createElement(\"div\",{className:styles.main},/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"h3\",null,\"\\u8BDA\\u610F\\u91D1: \",/*#__PURE__*/React.createElement(\"span\",null,obj.price,\"\\u5143\")),/*#__PURE__*/React.createElement(\"h3\",null,\"\\u6D3B\\u52A8\\u5956\\u54C1: \",/*#__PURE__*/React.createElement(\"span\",null,obj.gift))),/*#__PURE__*/React.createElement(\"ul\",null,obj.ensureList?obj.ensureList.map(function(item){return/*#__PURE__*/React.createElement(\"li\",{key:item},item);}):'')),/*#__PURE__*/React.createElement(\"div\",{className:styles.details},/*#__PURE__*/React.createElement(\"h3\",null,\"\\u6D3B\\u52A8\\u8BE6\\u60C5\"),/*#__PURE__*/React.createElement(\"div\",{dangerouslySetInnerHTML:{__html:obj.details}})),/*#__PURE__*/React.createElement(\"div\",{style:{backgroundColor:'#fff',marginTop:'15px'},className:styles.signUp},/*#__PURE__*/React.createElement(\"h3\",null,\"\\u6D3B\\u52A8\\u62A5\\u540D(\\u9700\\u652F\\u4ED8\\u8BDA\\u610F\\u91D1\",/*#__PURE__*/React.createElement(\"span\",null,\"\\uFFE5\",obj.price),\"\\u5143)\"),/*#__PURE__*/React.createElement(\"div\",{className:styles.item},/*#__PURE__*/React.createElement(\"span\",null,\"\\u6D3B\\u52A84S\\u5E97\\uFF1A\"),/*#__PURE__*/React.createElement(\"i\",null,obj.dealer?obj.dealer['name4s']:'')),/*#__PURE__*/React.createElement(\"div\",{className:styles.item},/*#__PURE__*/React.createElement(\"span\",null,\"\\u6D3B\\u52A8\\u5F00\\u59CB\\u65F6\\u95F4\\uFF1A\"),/*#__PURE__*/React.createElement(\"i\",null,obj.startDate)),/*#__PURE__*/React.createElement(\"div\",{className:styles.item},/*#__PURE__*/React.createElement(\"span\",null,\"\\u6D3B\\u52A8\\u7ED3\\u675F\\u65F6\\u95F4\\uFF1A\"),/*#__PURE__*/React.createElement(\"i\",null,obj.endDate)),/*#__PURE__*/React.createElement(_List,{className:styles.form},/*#__PURE__*/React.createElement(_InputItem,{placeholder:\"\\u8BF7\\u8F93\\u5165\\u60A8\\u7684\\u59D3\\u540D\",value:user.name,onChange:function onChange(v){return setUser(_objectSpread(_objectSpread({},user),{},{name:v}));}},\"\\u59D3\\u540D\"),/*#__PURE__*/React.createElement(_InputItem,{placeholder:\"\\u8BF7\\u8F93\\u5165\\u624B\\u673A\\u53F7\",value:user.phone,onChange:function onChange(v){return setUser(_objectSpread(_objectSpread({},user),{},{phone:v}));}},\"\\u624B\\u673A\\u53F7\\u7801\"),/*#__PURE__*/React.createElement(_InputItem,{placeholder:\"\\u8BF7\\u8F93\\u5165\\u9A8C\\u8BC1\\u7801\",value:user.code,onChange:function onChange(v){return setUser(_objectSpread(_objectSpread({},user),{},{code:v}));}},\"\\u9A8C\\u8BC1\\u7801\"),/*#__PURE__*/React.createElement(\"div\",{className:styles.btn},/*#__PURE__*/React.createElement(_Button,{size:\"small\",style:{width:'150px'},type:\"primary\",onClick:code},\"\\u83B7\\u53D6\\u9A8C\\u8BC1\\u7801\"),/*#__PURE__*/React.createElement(_Button,{size:\"small\",style:{width:'150px'},type:\"warning\",onClick:submit},\"\\u7ACB\\u5373\\u62A5\\u540D\")))),/*#__PURE__*/React.createElement(\"div\",{className:styles.process},/*#__PURE__*/React.createElement(\"h3\",{style:{padding:'10px'}},\"\\u6D3B\\u52A8\\u6D41\\u7A0B\"),/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"img\",{style:{width:'100%'},src:require('../../../assets/activity/1.png'),alt:\"\\u91CD\\u70B9\\u6C7D\\u8F66\"})),/*#__PURE__*/React.createElement(\"div\",{className:styles.top},/*#__PURE__*/React.createElement(\"div\",null,\"\\u8054\\u7CFB\\u7535\\u8BDD: \",obj.phone),/*#__PURE__*/React.createElement(\"div\",null,\"\\u6D3B\\u52A84S\\u5E97: \",obj.dealer?obj.dealer['name4s']:'')),/*#__PURE__*/React.createElement(\"div\",{className:styles.bottom},\"\\u672C\\u6D3B\\u52A8\\u6709\\u7ECF\\u9500\\u5546\\u7EC4\\u7EC7\\u5E76\\u8D1F\\u8D23\\uFF0C\\u6D3B\\u52A8\\u8BE6\\u7EC6\\u8BF7\\u54A8\\u8BE2\\u7ECF\\u9500\\u5546\\uFF0C\\u91CD\\u70B9\\u6C7D\\u8F66\\u7F51\\u4EC5\\u63D0\\u4F9B\\u6280\\u672F\\u652F\\u6301\")));};export default Gathering;","map":{"version":3,"sources":["D:/myCompany/zhongdianqiche/a/src/views/Activity/Gathering/index.js"],"names":["React","useState","useEffect","styles","url","axios","wexinPay","ISMOBILE","Gathering","props","id","parse","location","search","query","obj","setObj","name","phone","code","user","setUser","getLists","post","res","data","window","href","test","fail","submit","rew","gatherId","appId","nonceStr","package","paySign","signType","timeStamp","width","coverPic","title","logo","height","main","price","gift","ensureList","map","item","details","__html","backgroundColor","marginTop","signUp","dealer","startDate","endDate","form","v","btn","process","padding","require","top","bottom"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react'\r\nimport { InputItem, List, Button, Toast } from 'antd-mobile'\r\nimport styles from './index.module.css'\r\nimport url from 'url'\r\nimport axios from '../../../untils/axios'\r\nimport { wexinPay } from '../../../untils/wx'\r\n\r\n// 手机号正则\r\nconst ISMOBILE = /^[1][3,4,5,7,8,9][0-9]{9}$/\r\n\r\nconst Gathering = (props) => {\r\n  const id = url.parse(props.location.search, true).query.id\r\n  // 页面数据\r\n  const [obj, setObj] = useState({})\r\n  // 用户报名信息\r\n  const [user, setUser] = useState({name: '', phone: '', code: '', id: ''})\r\n  // 获取页面信息\r\n  useEffect(() => {\r\n    // 获取数据\r\n    const getLists = async () => {\r\n      // 授权登录\r\n      const { data: res } = await axios.post('/gather/getGather', { id })\r\n      setObj(res)\r\n    }\r\n    window.location.href = 'https://open.weixin.qq.com/connect/oauth2/authorize?appid=wx24ef6027f6157468&redirect_uri=www.zhongdianqiche.com/mobile/%23/pay&response_type=code&scope=snsapi_base#wechat_redirect'\r\n    getLists()\r\n  }, [])\r\n\r\n  // 获取验证码\r\n  const code = async () => {\r\n    if (!ISMOBILE.test(user.phone)) return Toast.fail('请输入正确的手机号', 2)\r\n    await axios.post('/user/sendCode', user)\r\n  }\r\n  // 报名参与\r\n  const submit = async () => {\r\n    if (!ISMOBILE.test(user.phone) || !user.name || !(/^\\d{4}$/.test(user.code))) return Toast.fail('请将信息填写完整', 2)\r\n    // 短信验证\r\n    setUser({...user, id: id})\r\n    const { data: rew } = await axios.post('/user/yzCode', user)\r\n    if (!rew) return Toast.fail('手机验证码错误', 2)\r\n    // 提交数据\r\n    const gatherId = user.id\r\n    const { data: res } = await axios.post('/gather/addSign', {...user, gatherId})\r\n    if (!res) return Toast.fail('报名失败', 2)\r\n    wexinPay(\r\n      {\r\n        appId: res.appId,\r\n        nonceStr: res.nonceStr,\r\n        package: res.package,\r\n        paySign: res.paySign,\r\n        signType: res.signType,\r\n        timeStamp: res.timeStamp\r\n      },\r\n      () => {\r\n        Toast.fail('支付成功', 2)\r\n      }\r\n    )\r\n    setUser({name: '', phone: '', code: '', id: ''})\r\n  }\r\n\r\n  return (\r\n    <div>\r\n      {/* 封面图 */}\r\n      <img style={{width: '100%'}} src={obj.coverPic} alt=\"重点汽车\"></img>\r\n      {/* 活动标题 */}\r\n      <div className={styles.title}>\r\n        <img src={obj.logo} alt=\"重点汽车\" style={{width: '100px', height: '100px'}} />\r\n        <h2>{obj.name}</h2>\r\n      </div>\r\n      <div className={styles.main}>\r\n        {/* 活动金额和礼品 */}\r\n        <div>\r\n          <h3>诚意金: <span>{obj.price}元</span></h3>\r\n          <h3>活动奖品: <span>{obj.gift}</span></h3>\r\n        </div>\r\n        {/* 活动保障 */}\r\n        <ul>\r\n          {\r\n            obj.ensureList ? obj.ensureList.map(item => {\r\n              return <li key={item}>{item}</li>\r\n            }): ''\r\n          }\r\n        </ul>\r\n      </div>\r\n      {/* 活动详情 */}\r\n      <div className={styles.details}>\r\n        <h3>活动详情</h3>\r\n        <div dangerouslySetInnerHTML={{__html: obj.details}}></div>\r\n      </div>\r\n      {/* 活动报名 */}\r\n      <div style={{backgroundColor: '#fff', marginTop: '15px'}} className={styles.signUp}>\r\n        <h3>活动报名(需支付诚意金<span>￥{obj.price}</span>元)</h3>\r\n        <div className={styles.item}>\r\n          <span>活动4S店：</span>\r\n          <i>{obj.dealer ? obj.dealer['name4s'] : ''}</i>\r\n        </div>\r\n        <div className={styles.item}>\r\n          <span>活动开始时间：</span>\r\n          <i>{obj.startDate}</i>\r\n        </div>\r\n        <div className={styles.item}>\r\n          <span>活动结束时间：</span>\r\n          <i>{obj.endDate}</i>\r\n        </div>\r\n        <List className={styles.form}>\r\n          <InputItem placeholder=\"请输入您的姓名\" value={user.name} onChange={v => setUser({...user, name: v})}>姓名</InputItem>\r\n          <InputItem placeholder=\"请输入手机号\" value={user.phone} onChange={v => setUser({...user, phone: v})}>手机号码</InputItem>\r\n          <InputItem placeholder=\"请输入验证码\" value={user.code} onChange={v => setUser({...user, code: v})}>验证码</InputItem>\r\n          <div className={styles.btn}>\r\n            <Button size=\"small\" style={{width: '150px'}} type=\"primary\" onClick={code}>获取验证码</Button>\r\n            <Button size=\"small\" style={{width: '150px'}} type=\"warning\" onClick={submit}>立即报名</Button>\r\n          </div>\r\n        </List>\r\n      </div>\r\n      {/* 活动流程 */}\r\n      <div className={styles.process}>\r\n        <h3 style={{padding: '10px'}}>活动流程</h3>\r\n        <div>\r\n          <img style={{width: '100%'}} src={require('../../../assets/activity/1.png')} alt=\"重点汽车\" />\r\n        </div>\r\n        <div className={styles.top}>\r\n          <div>联系电话: {obj.phone}</div>\r\n          <div>活动4S店: {obj.dealer ? obj.dealer['name4s'] : ''}</div>\r\n        </div>\r\n        <div className={styles.bottom}>\r\n          本活动有经销商组织并负责，活动详细请咨询经销商，重点汽车网仅提供技术支持\r\n        </div>\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default Gathering"]},"metadata":{},"sourceType":"module"}