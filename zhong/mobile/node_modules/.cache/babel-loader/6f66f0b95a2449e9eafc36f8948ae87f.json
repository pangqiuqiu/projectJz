{"ast":null,"code":"import _regeneratorRuntime from\"D:\\\\myCompany\\\\zhongdianqiche\\\\mobile\\\\node_modules\\\\@babel\\\\runtime/regenerator\";import _toConsumableArray from\"D:\\\\myCompany\\\\zhongdianqiche\\\\mobile\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/toConsumableArray\";import _asyncToGenerator from\"D:\\\\myCompany\\\\zhongdianqiche\\\\mobile\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"D:\\\\myCompany\\\\zhongdianqiche\\\\mobile\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";import _createClass from\"D:\\\\myCompany\\\\zhongdianqiche\\\\mobile\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";import _inherits from\"D:\\\\myCompany\\\\zhongdianqiche\\\\mobile\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";import _createSuper from\"D:\\\\myCompany\\\\zhongdianqiche\\\\mobile\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createSuper\";import React from'react';// 组件\nimport DownloadApp from'../../../components/DownloadApp';// axios\nimport axios from'../../../untils/axios';import styles from'./index.module.css';var Home=/*#__PURE__*/function(_React$Component){_inherits(Home,_React$Component);var _super=_createSuper(Home);function Home(props){var _this;_classCallCheck(this,Home);_this=_super.call(this,props);_this.handle=function(type,id){if(type==='重点号资讯'){_this.props.history.push(\"/infor_details?id=\".concat(id));}else{_this.props.history.push(\"/video_details?id=\".concat(id));}};_this.bindHandleScroll=function(){var winHeight=Math.ceil(window.scrollY+window.innerHeight);return winHeight>=document.body.scrollHeight-50;// 距离底部为50时候发送请求\n};_this.state={list:[],page:0,isLoadingMore:false};return _this;}_createClass(Home,[{key:\"componentDidMount\",value:function componentDidMount(){var _this2=this;// 获取首页列表数据\nthis.getHomeList();// 监听滚动事件\nvar wrapper=this.refs.wrapper;var loadMoreDataFn=this.loadMoreDataFn;var that=this;var timeCount;function callback(){var top=wrapper.getBoundingClientRect().top;// 加载更多距离顶部的距离\nvar windowHeight=window.screen.height;// 屏幕可视区域的高度\nif(top&&top<windowHeight){// 当 wrapper 已经被滚动到页面可视范围之内触发\nloadMoreDataFn(that);}}window.addEventListener('scroll',function(){if(_this2.state.isLoadingMore)return;if(timeCount){clearTimeout(timeCount);}timeCount=setTimeout(callback,500);},false);}// 加载更多事件\n},{key:\"loadMoreDataFn\",value:function(){var _loadMoreDataFn=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(that){var _yield$axios$post,res;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return that.setState({page:that.state.page+1});case 2:_context.next=4;return axios.post('/keyN/home',{pageNo:that.state.page,pageSize:14});case 4:_yield$axios$post=_context.sent;res=_yield$axios$post.data;that.setState({list:[].concat(_toConsumableArray(that.state.list),_toConsumableArray(res))});case 7:case\"end\":return _context.stop();}}},_callee);}));function loadMoreDataFn(_x){return _loadMoreDataFn.apply(this,arguments);}return loadMoreDataFn;}()// 获取列表数据\n},{key:\"getHomeList\",value:function(){var _getHomeList=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var _yield$axios$post2,res;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return axios.post('/keyN/home',{pageNo:this.state.page,pageSize:14});case 2:_yield$axios$post2=_context2.sent;res=_yield$axios$post2.data;this.setState({list:res});case 5:case\"end\":return _context2.stop();}}},_callee2,this);}));function getHomeList(){return _getHomeList.apply(this,arguments);}return getHomeList;}()// 跳转\n},{key:\"render\",value:function render(){var _this3=this;return/*#__PURE__*/React.createElement(\"div\",{style:{paddingTop:'70px',paddingBottom:'50px'}},/*#__PURE__*/React.createElement(DownloadApp,null),/*#__PURE__*/React.createElement(\"ul\",{className:styles.inforList},this.state.list.map(function(item){return/*#__PURE__*/React.createElement(\"li\",{style:{backgroundColor:'#fff'},onClick:function onClick(){_this3.handle(item.type,item.id);},className:styles.inforList_item,key:item.id},/*#__PURE__*/React.createElement(\"div\",{style:{borderRadius:'5px 5px 0 0',overflow:'hidden'}},/*#__PURE__*/React.createElement(\"img\",{alt:\"\",style:{height:'100%'},src:item.object.coverPic})),/*#__PURE__*/React.createElement(\"h3\",{className:styles.title,style:{minHeight:'48.8px',overflow:'hidden'}},item.object.title),/*#__PURE__*/React.createElement(\"div\",{className:styles.user},/*#__PURE__*/React.createElement(\"img\",{style:{width:'25px',height:'25px',marginRight:'10px',borderRadius:'50%'},alt:\"\",src:item.key.headPic}),/*#__PURE__*/React.createElement(\"span\",{style:{fontSize:'12px',display:'inlineBlock',width:'80px'}},item.key.name),/*#__PURE__*/React.createElement(\"img\",{alt:\"\",style:{width:'15px',height:'15px',verticalAlign:'top'},src:require('../../../assets/home/dianzan@2x.png')})));})),/*#__PURE__*/React.createElement(\"div\",{className:styles.loadMore,ref:\"wrapper\",onClick:this.loadMoreDataFn.bind(this,this)}));}}]);return Home;}(React.Component);export{Home as default};","map":null,"metadata":{},"sourceType":"module"}