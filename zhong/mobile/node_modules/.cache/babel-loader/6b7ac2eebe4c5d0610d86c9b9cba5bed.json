{"ast":null,"code":"import \"antd-mobile/lib/list/style/css\";\nimport _List from \"antd-mobile/lib/list\";\nimport \"antd-mobile/lib/button/style/css\";\nimport _Button from \"antd-mobile/lib/button\";\nimport \"antd-mobile/lib/input-item/style/css\";\nimport _InputItem from \"antd-mobile/lib/input-item\";\nimport \"antd-mobile/lib/toast/style/css\";\nimport _Toast from \"antd-mobile/lib/toast\";\nvar _jsxFileName = \"D:\\\\myCompany\\\\zhongdianqiche\\\\mobile\\\\src\\\\views\\\\Activity\\\\Gathering\\\\index.js\";\nimport React, { useState, useEffect } from 'react';\nimport styles from './index.module.css';\nimport url from 'url';\nimport axios from '../../../untils/axios';\nimport { wexinPay } from '../../../untils/wx'; // 手机号正则\n\nconst ISMOBILE = /^[1][3,4,5,7,8,9][0-9]{9}$/;\n\nconst Gathering = props => {\n  // 页面数据\n  const [obj, setObj] = useState({}); // 用户报名信息\n\n  const [user, setUser] = useState({\n    name: '',\n    phone: '',\n    code: '',\n    id: url.parse(props.location.search, true).query.id\n  }); // 获取页面信息\n\n  useEffect(() => {\n    // 获取数据\n    const getLists = async () => {\n      // 授权登录\n      const {\n        data: res\n      } = await axios.post('/gather/getGather', {\n        id: user.id\n      });\n      setObj(res);\n    };\n\n    getLists();\n  }, []); // 获取验证码\n\n  const code = async () => {\n    if (!ISMOBILE.test(user.phone)) return _Toast.fail('请输入正确的手机号', 2);\n    await axios.post('/user/sendCode', user);\n  }; // 报名参与\n\n\n  const submit = async () => {\n    if (!ISMOBILE.test(user.phone) || !user.name || !/^\\d{4}$/.test(user.code)) return _Toast.fail('请将信息填写完整', 2); // 短信验证\n\n    const {\n      data: rew\n    } = await axios.post('/user/yzCode', user);\n    if (!rew) return _Toast.fail('手机验证码错误', 2); // 微信登录验证\n\n    localStorage.setItem('user', JSON.stringify(user));\n    window.location.href = `https://open.weixin.qq.com/connect/oauth2/authorize?appid=wx24ef6027f6157468&redirect_uri=https://www.zhongdianqiche.com/mobile/%23/pay/${user}&response_type=code&scope=snsapi_base&state=128#wechat_redirect`;\n    setTimeout(async () => {\n      // 提交数据\n      setUser(JSON.parse(localStorage.getItem('user')));\n      const code = window.location.href;\n      const {\n        data: res\n      } = await axios.post('/gather/addSign', { ...user,\n        gatherId: user.id,\n        code: code\n      });\n      if (!res) return _Toast.fail('报名失败', 2);\n      wexinPay({\n        appId: res.appId,\n        nonceStr: res.nonceStr,\n        package: res.package,\n        paySign: res.paySign,\n        signType: res.signType,\n        timeStamp: res.timeStamp\n      }, () => {\n        _Toast.fail('支付成功', 2);\n      });\n      setUser({\n        name: '',\n        phone: '',\n        code: '',\n        id: ''\n      });\n    }, 1000);\n  };\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 65,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"img\", {\n    style: {\n      width: '100%'\n    },\n    src: obj.coverPic,\n    alt: \"\\u91CD\\u70B9\\u6C7D\\u8F66\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 67,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.title,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 69,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"img\", {\n    src: obj.logo,\n    alt: \"\\u91CD\\u70B9\\u6C7D\\u8F66\",\n    style: {\n      width: '100px',\n      height: '100px'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 70,\n      columnNumber: 9\n    }\n  }), /*#__PURE__*/React.createElement(\"h2\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 71,\n      columnNumber: 9\n    }\n  }, obj.name)), /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.main,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 73,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 75,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"h3\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 76,\n      columnNumber: 11\n    }\n  }, \"\\u8BDA\\u610F\\u91D1: \", /*#__PURE__*/React.createElement(\"span\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 76,\n      columnNumber: 20\n    }\n  }, obj.price, \"\\u5143\")), /*#__PURE__*/React.createElement(\"h3\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 77,\n      columnNumber: 11\n    }\n  }, \"\\u6D3B\\u52A8\\u5956\\u54C1: \", /*#__PURE__*/React.createElement(\"span\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 77,\n      columnNumber: 21\n    }\n  }, obj.gift))), /*#__PURE__*/React.createElement(\"ul\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 80,\n      columnNumber: 9\n    }\n  }, obj.ensureList ? obj.ensureList.map(item => {\n    return /*#__PURE__*/React.createElement(\"li\", {\n      key: item,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 83,\n        columnNumber: 22\n      }\n    }, item);\n  }) : '')), /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.details,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 89,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"h3\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 90,\n      columnNumber: 9\n    }\n  }, \"\\u6D3B\\u52A8\\u8BE6\\u60C5\"), /*#__PURE__*/React.createElement(\"div\", {\n    dangerouslySetInnerHTML: {\n      __html: obj.details\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 91,\n      columnNumber: 9\n    }\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      backgroundColor: '#fff',\n      marginTop: '15px'\n    },\n    className: styles.signUp,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 94,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"h3\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 95,\n      columnNumber: 9\n    }\n  }, \"\\u6D3B\\u52A8\\u62A5\\u540D(\\u9700\\u652F\\u4ED8\\u8BDA\\u610F\\u91D1\", /*#__PURE__*/React.createElement(\"span\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 95,\n      columnNumber: 24\n    }\n  }, \"\\uFFE5\", obj.price), \"\\u5143)\"), /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.item,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 96,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 97,\n      columnNumber: 11\n    }\n  }, \"\\u6D3B\\u52A84S\\u5E97\\uFF1A\"), /*#__PURE__*/React.createElement(\"i\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 98,\n      columnNumber: 11\n    }\n  }, obj.dealer ? obj.dealer['name4s'] : '')), /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.item,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 100,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 101,\n      columnNumber: 11\n    }\n  }, \"\\u6D3B\\u52A8\\u5F00\\u59CB\\u65F6\\u95F4\\uFF1A\"), /*#__PURE__*/React.createElement(\"i\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 102,\n      columnNumber: 11\n    }\n  }, obj.startDate)), /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.item,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 104,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 105,\n      columnNumber: 11\n    }\n  }, \"\\u6D3B\\u52A8\\u7ED3\\u675F\\u65F6\\u95F4\\uFF1A\"), /*#__PURE__*/React.createElement(\"i\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 106,\n      columnNumber: 11\n    }\n  }, obj.endDate)), /*#__PURE__*/React.createElement(_List, {\n    className: styles.form,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 108,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(_InputItem, {\n    placeholder: \"\\u8BF7\\u8F93\\u5165\\u60A8\\u7684\\u59D3\\u540D\",\n    value: user.name,\n    onChange: v => setUser({ ...user,\n      name: v\n    }),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 109,\n      columnNumber: 11\n    }\n  }, \"\\u59D3\\u540D\"), /*#__PURE__*/React.createElement(_InputItem, {\n    placeholder: \"\\u8BF7\\u8F93\\u5165\\u624B\\u673A\\u53F7\",\n    value: user.phone,\n    onChange: v => setUser({ ...user,\n      phone: v\n    }),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 110,\n      columnNumber: 11\n    }\n  }, \"\\u624B\\u673A\\u53F7\\u7801\"), /*#__PURE__*/React.createElement(_InputItem, {\n    placeholder: \"\\u8BF7\\u8F93\\u5165\\u9A8C\\u8BC1\\u7801\",\n    value: user.code,\n    onChange: v => setUser({ ...user,\n      code: v\n    }),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 111,\n      columnNumber: 11\n    }\n  }, \"\\u9A8C\\u8BC1\\u7801\"), /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.btn,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 112,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(_Button, {\n    size: \"small\",\n    style: {\n      width: '150px'\n    },\n    type: \"primary\",\n    onClick: code,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 113,\n      columnNumber: 13\n    }\n  }, \"\\u83B7\\u53D6\\u9A8C\\u8BC1\\u7801\"), /*#__PURE__*/React.createElement(_Button, {\n    size: \"small\",\n    style: {\n      width: '150px'\n    },\n    type: \"warning\",\n    onClick: submit,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 114,\n      columnNumber: 13\n    }\n  }, \"\\u7ACB\\u5373\\u62A5\\u540D\")))), /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.process,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 119,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"h3\", {\n    style: {\n      padding: '10px'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 120,\n      columnNumber: 9\n    }\n  }, \"\\u6D3B\\u52A8\\u6D41\\u7A0B\"), /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 121,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"img\", {\n    style: {\n      width: '100%'\n    },\n    src: require('../../../assets/activity/1.png'),\n    alt: \"\\u91CD\\u70B9\\u6C7D\\u8F66\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 122,\n      columnNumber: 11\n    }\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.top,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 124,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 125,\n      columnNumber: 11\n    }\n  }, \"\\u8054\\u7CFB\\u7535\\u8BDD: \", obj.phone), /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 126,\n      columnNumber: 11\n    }\n  }, \"\\u6D3B\\u52A84S\\u5E97: \", obj.dealer ? obj.dealer['name4s'] : '')), /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.bottom,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 128,\n      columnNumber: 9\n    }\n  }, \"\\u672C\\u6D3B\\u52A8\\u6709\\u7ECF\\u9500\\u5546\\u7EC4\\u7EC7\\u5E76\\u8D1F\\u8D23\\uFF0C\\u6D3B\\u52A8\\u8BE6\\u7EC6\\u8BF7\\u54A8\\u8BE2\\u7ECF\\u9500\\u5546\\uFF0C\\u91CD\\u70B9\\u6C7D\\u8F66\\u7F51\\u4EC5\\u63D0\\u4F9B\\u6280\\u672F\\u652F\\u6301\")));\n};\n\nexport default Gathering;","map":{"version":3,"sources":["D:/myCompany/zhongdianqiche/mobile/src/views/Activity/Gathering/index.js"],"names":["React","useState","useEffect","styles","url","axios","wexinPay","ISMOBILE","Gathering","props","obj","setObj","user","setUser","name","phone","code","id","parse","location","search","query","getLists","data","res","post","test","fail","submit","rew","localStorage","setItem","JSON","stringify","window","href","setTimeout","getItem","gatherId","appId","nonceStr","package","paySign","signType","timeStamp","width","coverPic","title","logo","height","main","price","gift","ensureList","map","item","details","__html","backgroundColor","marginTop","signUp","dealer","startDate","endDate","form","v","btn","process","padding","require","top","bottom"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react'\r\nimport { InputItem, List, Button, Toast } from 'antd-mobile'\r\nimport styles from './index.module.css'\r\nimport url from 'url'\r\nimport axios from '../../../untils/axios'\r\nimport { wexinPay } from '../../../untils/wx'\r\n\r\n// 手机号正则\r\nconst ISMOBILE = /^[1][3,4,5,7,8,9][0-9]{9}$/\r\n\r\nconst Gathering = (props) => {\r\n  // 页面数据\r\n  const [obj, setObj] = useState({})\r\n  // 用户报名信息\r\n  const [user, setUser] = useState({name: '', phone: '', code: '', id: url.parse(props.location.search, true).query.id})\r\n  // 获取页面信息\r\n  useEffect(() => {\r\n    // 获取数据\r\n    const getLists = async () => {\r\n      // 授权登录\r\n      const { data: res } = await axios.post('/gather/getGather', { id: user.id })\r\n      setObj(res)\r\n    }\r\n    getLists()\r\n  }, [])\r\n\r\n  // 获取验证码\r\n  const code = async () => {\r\n    if (!ISMOBILE.test(user.phone)) return Toast.fail('请输入正确的手机号', 2)\r\n    await axios.post('/user/sendCode', user)\r\n  }\r\n  // 报名参与\r\n  const submit = async () => {\r\n    if (!ISMOBILE.test(user.phone) || !user.name || !(/^\\d{4}$/.test(user.code))) return Toast.fail('请将信息填写完整', 2)\r\n    // 短信验证\r\n    const { data: rew } = await axios.post('/user/yzCode', user)\r\n    if (!rew) return Toast.fail('手机验证码错误', 2)\r\n    // 微信登录验证\r\n    localStorage.setItem('user', JSON.stringify(user))\r\n    window.location.href = `https://open.weixin.qq.com/connect/oauth2/authorize?appid=wx24ef6027f6157468&redirect_uri=https://www.zhongdianqiche.com/mobile/%23/pay/${user}&response_type=code&scope=snsapi_base&state=128#wechat_redirect`\r\n    setTimeout(async () => {\r\n      // 提交数据\r\n      setUser(JSON.parse(localStorage.getItem('user')))\r\n      const code = window.location.href\r\n      const { data: res } = await axios.post('/gather/addSign', {...user, gatherId: user.id, code: code})\r\n      if (!res) return Toast.fail('报名失败', 2)\r\n      wexinPay(\r\n        {\r\n          appId: res.appId,\r\n          nonceStr: res.nonceStr,\r\n          package: res.package,\r\n          paySign: res.paySign,\r\n          signType: res.signType,\r\n          timeStamp: res.timeStamp\r\n        },\r\n        () => {\r\n          Toast.fail('支付成功', 2)\r\n        }\r\n      )\r\n      setUser({name: '', phone: '', code: '', id: ''})\r\n    }, 1000)\r\n  }\r\n\r\n  return (\r\n    <div>\r\n      {/* 封面图 */}\r\n      <img style={{width: '100%'}} src={obj.coverPic} alt=\"重点汽车\"></img>\r\n      {/* 活动标题 */}\r\n      <div className={styles.title}>\r\n        <img src={obj.logo} alt=\"重点汽车\" style={{width: '100px', height: '100px'}} />\r\n        <h2>{obj.name}</h2>\r\n      </div>\r\n      <div className={styles.main}>\r\n        {/* 活动金额和礼品 */}\r\n        <div>\r\n          <h3>诚意金: <span>{obj.price}元</span></h3>\r\n          <h3>活动奖品: <span>{obj.gift}</span></h3>\r\n        </div>\r\n        {/* 活动保障 */}\r\n        <ul>\r\n          {\r\n            obj.ensureList ? obj.ensureList.map(item => {\r\n              return <li key={item}>{item}</li>\r\n            }): ''\r\n          }\r\n        </ul>\r\n      </div>\r\n      {/* 活动详情 */}\r\n      <div className={styles.details}>\r\n        <h3>活动详情</h3>\r\n        <div dangerouslySetInnerHTML={{__html: obj.details}}></div>\r\n      </div>\r\n      {/* 活动报名 */}\r\n      <div style={{backgroundColor: '#fff', marginTop: '15px'}} className={styles.signUp}>\r\n        <h3>活动报名(需支付诚意金<span>￥{obj.price}</span>元)</h3>\r\n        <div className={styles.item}>\r\n          <span>活动4S店：</span>\r\n          <i>{obj.dealer ? obj.dealer['name4s'] : ''}</i>\r\n        </div>\r\n        <div className={styles.item}>\r\n          <span>活动开始时间：</span>\r\n          <i>{obj.startDate}</i>\r\n        </div>\r\n        <div className={styles.item}>\r\n          <span>活动结束时间：</span>\r\n          <i>{obj.endDate}</i>\r\n        </div>\r\n        <List className={styles.form}>\r\n          <InputItem placeholder=\"请输入您的姓名\" value={user.name} onChange={v => setUser({...user, name: v})}>姓名</InputItem>\r\n          <InputItem placeholder=\"请输入手机号\" value={user.phone} onChange={v => setUser({...user, phone: v})}>手机号码</InputItem>\r\n          <InputItem placeholder=\"请输入验证码\" value={user.code} onChange={v => setUser({...user, code: v})}>验证码</InputItem>\r\n          <div className={styles.btn}>\r\n            <Button size=\"small\" style={{width: '150px'}} type=\"primary\" onClick={code}>获取验证码</Button>\r\n            <Button size=\"small\" style={{width: '150px'}} type=\"warning\" onClick={submit}>立即报名</Button>\r\n          </div>\r\n        </List>\r\n      </div>\r\n      {/* 活动流程 */}\r\n      <div className={styles.process}>\r\n        <h3 style={{padding: '10px'}}>活动流程</h3>\r\n        <div>\r\n          <img style={{width: '100%'}} src={require('../../../assets/activity/1.png')} alt=\"重点汽车\" />\r\n        </div>\r\n        <div className={styles.top}>\r\n          <div>联系电话: {obj.phone}</div>\r\n          <div>活动4S店: {obj.dealer ? obj.dealer['name4s'] : ''}</div>\r\n        </div>\r\n        <div className={styles.bottom}>\r\n          本活动有经销商组织并负责，活动详细请咨询经销商，重点汽车网仅提供技术支持\r\n        </div>\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default Gathering"]},"metadata":{},"sourceType":"module"}