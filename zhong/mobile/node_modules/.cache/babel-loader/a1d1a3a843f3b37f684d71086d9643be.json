{"ast":null,"code":"var _jsxFileName = \"D:\\\\myCompany\\\\zhongdianqiche\\\\mobile\\\\src\\\\views\\\\Manage\\\\Customer\\\\index.js\";\nimport React from 'react'; // axios\n\nimport axios from '../../../untils/axios';\nimport styles from './index.module.css';\nexport default class ManageCustomer extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.bindHandleScroll = () => {\n      let winHeight = Math.ceil(window.scrollY + window.innerHeight);\n      return winHeight >= document.body.scrollHeight - 50; // 距离底部为50时候发送请求\n    };\n\n    this.state = {\n      list: [],\n      page: 1,\n      isLoadingMore: false\n    };\n  }\n\n  componentDidMount() {\n    // 获取首页列表数据\n    this.getHomeList(); // 监听滚动事件\n\n    const wrapper = this.refs.wrapper;\n    const loadMoreDataFn = this.loadMoreDataFn;\n    const that = this;\n    let timeCount;\n\n    function callback() {\n      const top = wrapper.getBoundingClientRect().top; // 加载更多距离顶部的距离\n\n      const windowHeight = window.screen.height; // 屏幕可视区域的高度\n\n      if (top && top < windowHeight) {\n        // 当 wrapper 已经被滚动到页面可视范围之内触发\n        loadMoreDataFn(that);\n      }\n    }\n\n    window.addEventListener('scroll', () => {\n      if (this.state.isLoadingMore) return;\n\n      if (timeCount) {\n        clearTimeout(timeCount);\n      }\n\n      timeCount = setTimeout(callback, 500);\n    }, false);\n  } // 加载更多事件\n\n\n  async loadMoreDataFn(that) {\n    await that.setState({\n      page: that.state.page + 1\n    });\n    const {\n      data: res\n    } = await axios.post('/keyN/home', {\n      pageNo: that.state.page,\n      pageSize: 14\n    });\n    that.setState({\n      list: [...that.state.list, ...res]\n    });\n  } // 获取列表数据\n\n\n  async getHomeList() {\n    const {\n      data: res\n    } = await axios.post('/keyN/home', {\n      pageNo: this.state.page,\n      pageSize: 10\n    });\n    this.setState({\n      list: res\n    });\n  } // 监听滚动事件\n\n\n  render() {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 63,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(\"ul\", {\n      className: styles.inforList,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 65,\n        columnNumber: 9\n      }\n    }, this.state.list.map(item => {\n      return /*#__PURE__*/React.createElement(\"li\", {\n        key: item.id,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 68,\n          columnNumber: 22\n        }\n      }, /*#__PURE__*/React.createElement(\"h1\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 69,\n          columnNumber: 17\n        }\n      }, \"11111\"));\n    })), /*#__PURE__*/React.createElement(\"div\", {\n      className: styles.loadMore,\n      ref: \"wrapper\",\n      onClick: this.loadMoreDataFn.bind(this, this),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 74,\n        columnNumber: 9\n      }\n    }));\n  }\n\n}","map":{"version":3,"sources":["D:/myCompany/zhongdianqiche/mobile/src/views/Manage/Customer/index.js"],"names":["React","axios","styles","ManageCustomer","Component","constructor","props","bindHandleScroll","winHeight","Math","ceil","window","scrollY","innerHeight","document","body","scrollHeight","state","list","page","isLoadingMore","componentDidMount","getHomeList","wrapper","refs","loadMoreDataFn","that","timeCount","callback","top","getBoundingClientRect","windowHeight","screen","height","addEventListener","clearTimeout","setTimeout","setState","data","res","post","pageNo","pageSize","render","inforList","map","item","id","loadMore","bind"],"mappings":"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","sourcesContent":["import React from 'react'\r\n// axios\r\nimport axios from '../../../untils/axios'\r\nimport styles from './index.module.css'\r\n\r\nexport default class ManageCustomer extends React.Component {\r\n  constructor (props) {\r\n    super(props)\r\n    this.state = {\r\n      list: [],\r\n      page: 1,\r\n      isLoadingMore: false\r\n    }\r\n  }\r\n  componentDidMount () {\r\n    // 获取首页列表数据\r\n    this.getHomeList()\r\n    // 监听滚动事件\r\n    const wrapper = this.refs.wrapper\r\n    const loadMoreDataFn = this.loadMoreDataFn\r\n    const that = this\r\n    let timeCount\r\n    function callback () {\r\n      const top = wrapper.getBoundingClientRect().top // 加载更多距离顶部的距离\r\n      const windowHeight = window.screen.height // 屏幕可视区域的高度\r\n      if (top && top < windowHeight) {\r\n        // 当 wrapper 已经被滚动到页面可视范围之内触发\r\n        loadMoreDataFn(that)\r\n      } \r\n    }\r\n    window.addEventListener('scroll', () => {\r\n      if (this.state.isLoadingMore) return\r\n      if (timeCount) {\r\n        clearTimeout(timeCount)\r\n      }\r\n      timeCount = setTimeout(callback, 500)\r\n    }, false)\r\n  }\r\n  // 加载更多事件\r\n  async loadMoreDataFn (that) {\r\n    await that.setState({ page: that.state.page + 1 })\r\n    const { data: res } = await axios.post('/keyN/home', {\r\n      pageNo: that.state.page,\r\n      pageSize: 14\r\n    })\r\n    that.setState({ list: [...that.state.list,...res] })\r\n  }\r\n  // 获取列表数据\r\n  async getHomeList () {\r\n    const { data: res } = await axios.post('/keyN/home', {\r\n      pageNo: this.state.page,\r\n      pageSize: 10\r\n    })\r\n    this.setState({ list: res })\r\n  }\r\n  // 监听滚动事件\r\n  bindHandleScroll =() => {\r\n    let winHeight = Math.ceil(window.scrollY + window.innerHeight)\r\n    return winHeight >= document.body.scrollHeight - 50 // 距离底部为50时候发送请求\r\n  }\r\n  render () {\r\n    return (\r\n      <div>\r\n        {/* 首页列表 */}\r\n        <ul className={styles.inforList}>\r\n          {\r\n            this.state.list.map(item => {\r\n              return <li key={item.id}>\r\n                <h1>11111</h1>\r\n              </li>\r\n            })\r\n          }\r\n        </ul>\r\n        <div\r\n          className={styles.loadMore}\r\n          ref=\"wrapper\"\r\n          onClick={this.loadMoreDataFn.bind(this, this)}\r\n        >\r\n        </div>\r\n      </div>\r\n    )\r\n  }\r\n}"]},"metadata":{},"sourceType":"module"}