{"ast":null,"code":"import\"antd-mobile/lib/list/style/css\";import _List from\"antd-mobile/lib/list\";import\"antd-mobile/lib/button/style/css\";import _Button from\"antd-mobile/lib/button\";import\"antd-mobile/lib/input-item/style/css\";import _InputItem from\"antd-mobile/lib/input-item\";import _objectSpread from\"D:\\\\myCompany\\\\zhongdianqiche\\\\mobile\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/objectSpread2\";import\"antd-mobile/lib/toast/style/css\";import _Toast from\"antd-mobile/lib/toast\";import _regeneratorRuntime from\"D:\\\\myCompany\\\\zhongdianqiche\\\\mobile\\\\node_modules\\\\@babel\\\\runtime/regenerator\";import _asyncToGenerator from\"D:\\\\myCompany\\\\zhongdianqiche\\\\mobile\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"D:\\\\myCompany\\\\zhongdianqiche\\\\mobile\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from'react';import styles from'./index.module.css';import url from'url';import axios from'../../../untils/axios';// 手机号正则\nvar ISMOBILE=/^[1][3,4,5,7,8,9][0-9]{9}$/;var Gathering=function Gathering(props){// 页面数据\nvar _useState=useState({}),_useState2=_slicedToArray(_useState,2),obj=_useState2[0],setObj=_useState2[1];// 用户报名信息\nvar _useState3=useState({name:'',phone:'',code:'',id:url.parse(props.location.search,true).query.id}),_useState4=_slicedToArray(_useState3,2),user=_useState4[0],setUser=_useState4[1];// 获取页面信息\nuseEffect(function(){// 获取数据\nvar getLists=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var _yield$axios$post,res;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return axios.post('/gather/getGather',{id:user.id});case 2:_yield$axios$post=_context.sent;res=_yield$axios$post.data;setObj(res);case 5:case\"end\":return _context.stop();}}},_callee);}));return function getLists(){return _ref.apply(this,arguments);};}();getLists();},[]);// 获取验证码\nvar code=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:if(ISMOBILE.test(user.phone)){_context2.next=2;break;}return _context2.abrupt(\"return\",_Toast.fail('请输入正确的手机号',2));case 2:_context2.next=4;return axios.post('/user/sendCode',user);case 4:case\"end\":return _context2.stop();}}},_callee2);}));return function code(){return _ref2.apply(this,arguments);};}();// 报名参与\nvar submit=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(){var _yield$axios$post2,rew,u;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:if(!(!ISMOBILE.test(user.phone)||!user.name||!/^\\d{4}$/.test(user.code))){_context3.next=2;break;}return _context3.abrupt(\"return\",_Toast.fail('请将信息填写完整',2));case 2:_context3.next=4;return axios.post('/user/yzCode',user);case 4:_yield$axios$post2=_context3.sent;rew=_yield$axios$post2.data;if(rew){_context3.next=8;break;}return _context3.abrupt(\"return\",_Toast.fail('手机验证码错误',2));case 8:u=JSON.stringify(user);window.location.href=\"https://open.weixin.qq.com/connect/oauth2/authorize?appid=wx24ef6027f6157468&redirect_uri=https://www.zhongdianqiche.com/mobile/%23/pay/\".concat(u,\"&response_type=code&scope=snsapi_base&state=128#wechat_redirect\");case 10:case\"end\":return _context3.stop();}}},_callee3);}));return function submit(){return _ref3.apply(this,arguments);};}();return/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"img\",{style:{width:'100%'},src:obj.coverPic,alt:\"\\u91CD\\u70B9\\u6C7D\\u8F66\"}),/*#__PURE__*/React.createElement(\"div\",{className:styles.title},/*#__PURE__*/React.createElement(\"img\",{src:obj.logo,alt:\"\\u91CD\\u70B9\\u6C7D\\u8F66\",style:{width:'100px',height:'100px'}}),/*#__PURE__*/React.createElement(\"h2\",null,obj.name)),/*#__PURE__*/React.createElement(\"div\",{className:styles.main},/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"h3\",null,\"\\u8BDA\\u610F\\u91D1: \",/*#__PURE__*/React.createElement(\"span\",null,obj.price,\"\\u5143\")),/*#__PURE__*/React.createElement(\"h3\",null,\"\\u6D3B\\u52A8\\u5956\\u54C1: \",/*#__PURE__*/React.createElement(\"span\",null,obj.gift))),/*#__PURE__*/React.createElement(\"ul\",null,obj.ensureList?obj.ensureList.map(function(item){return/*#__PURE__*/React.createElement(\"li\",{key:item},item);}):'')),/*#__PURE__*/React.createElement(\"div\",{className:styles.details},/*#__PURE__*/React.createElement(\"h3\",null,\"\\u6D3B\\u52A8\\u8BE6\\u60C5\"),/*#__PURE__*/React.createElement(\"div\",{dangerouslySetInnerHTML:{__html:obj.details}})),/*#__PURE__*/React.createElement(\"div\",{style:{backgroundColor:'#fff',marginTop:'15px'},className:styles.signUp},/*#__PURE__*/React.createElement(\"h3\",null,\"\\u6D3B\\u52A8\\u62A5\\u540D(\\u9700\\u652F\\u4ED8\\u8BDA\\u610F\\u91D1\",/*#__PURE__*/React.createElement(\"span\",null,\"\\uFFE5\",obj.price),\"\\u5143)\"),/*#__PURE__*/React.createElement(\"div\",{className:styles.item},/*#__PURE__*/React.createElement(\"span\",null,\"\\u6D3B\\u52A84S\\u5E97\\uFF1A\"),/*#__PURE__*/React.createElement(\"i\",null,obj.dealer?obj.dealer['name4s']:'')),/*#__PURE__*/React.createElement(\"div\",{className:styles.item},/*#__PURE__*/React.createElement(\"span\",null,\"\\u6D3B\\u52A8\\u5F00\\u59CB\\u65F6\\u95F4\\uFF1A\"),/*#__PURE__*/React.createElement(\"i\",null,obj.startDate)),/*#__PURE__*/React.createElement(\"div\",{className:styles.item},/*#__PURE__*/React.createElement(\"span\",null,\"\\u6D3B\\u52A8\\u7ED3\\u675F\\u65F6\\u95F4\\uFF1A\"),/*#__PURE__*/React.createElement(\"i\",null,obj.endDate)),/*#__PURE__*/React.createElement(_List,{className:styles.form},/*#__PURE__*/React.createElement(_InputItem,{placeholder:\"\\u8BF7\\u8F93\\u5165\\u60A8\\u7684\\u59D3\\u540D\",value:user.name,onChange:function onChange(v){return setUser(_objectSpread(_objectSpread({},user),{},{name:v}));}},\"\\u59D3\\u540D\"),/*#__PURE__*/React.createElement(_InputItem,{placeholder:\"\\u8BF7\\u8F93\\u5165\\u624B\\u673A\\u53F7\",value:user.phone,onChange:function onChange(v){return setUser(_objectSpread(_objectSpread({},user),{},{phone:v}));}},\"\\u624B\\u673A\\u53F7\\u7801\"),/*#__PURE__*/React.createElement(_InputItem,{placeholder:\"\\u8BF7\\u8F93\\u5165\\u9A8C\\u8BC1\\u7801\",value:user.code,onChange:function onChange(v){return setUser(_objectSpread(_objectSpread({},user),{},{code:v}));}},\"\\u9A8C\\u8BC1\\u7801\"),/*#__PURE__*/React.createElement(\"div\",{className:styles.btn},/*#__PURE__*/React.createElement(_Button,{size:\"small\",style:{width:'150px'},type:\"primary\",onClick:code},\"\\u83B7\\u53D6\\u9A8C\\u8BC1\\u7801\"),/*#__PURE__*/React.createElement(_Button,{size:\"small\",style:{width:'150px'},type:\"warning\",onClick:submit},\"\\u7ACB\\u5373\\u62A5\\u540D\")))),/*#__PURE__*/React.createElement(\"div\",{className:styles.process},/*#__PURE__*/React.createElement(\"h3\",{style:{padding:'10px'}},\"\\u6D3B\\u52A8\\u6D41\\u7A0B\"),/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"img\",{style:{width:'100%'},src:require('../../../assets/activity/1.png'),alt:\"\\u91CD\\u70B9\\u6C7D\\u8F66\"})),/*#__PURE__*/React.createElement(\"div\",{className:styles.top},/*#__PURE__*/React.createElement(\"div\",null,\"\\u8054\\u7CFB\\u7535\\u8BDD: \",obj.phone),/*#__PURE__*/React.createElement(\"div\",null,\"\\u6D3B\\u52A84S\\u5E97: \",obj.dealer?obj.dealer['name4s']:'')),/*#__PURE__*/React.createElement(\"div\",{className:styles.bottom},\"\\u672C\\u6D3B\\u52A8\\u6709\\u7ECF\\u9500\\u5546\\u7EC4\\u7EC7\\u5E76\\u8D1F\\u8D23\\uFF0C\\u6D3B\\u52A8\\u8BE6\\u7EC6\\u8BF7\\u54A8\\u8BE2\\u7ECF\\u9500\\u5546\\uFF0C\\u91CD\\u70B9\\u6C7D\\u8F66\\u7F51\\u4EC5\\u63D0\\u4F9B\\u6280\\u672F\\u652F\\u6301\")));};export default Gathering;","map":null,"metadata":{},"sourceType":"module"}